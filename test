
import openpyxl

def clear_rows_from_fifth(path, sheet_name="aaasheet"):
    # æ‰“å¼€ Excel æ–‡ä»¶
    wb = openpyxl.load_workbook(path)
    
    # é€‰æ‹©æŒ‡å®šçš„å·¥ä½œè¡¨
    if sheet_name not in wb.sheetnames:
        print(f"å·¥ä½œè¡¨ {sheet_name} ä¸å­˜åœ¨")
        return
    
    ws = wb[sheet_name]
    
    # éå†ç¬¬5è¡Œåˆ°æœ€åä¸€è¡Œï¼Œæ¸…ç©ºå†…å®¹
    for row in ws.iter_rows(min_row=5, max_row=ws.max_row):
        for cell in row:
            cell.value = None
    
    # ä¿å­˜ä¿®æ”¹
    wb.save(path)
    print(f"æ–‡ä»¶ {path} ä¸­ {sheet_name} çš„ç¬¬5è¡ŒåŠä¹‹åçš„å†…å®¹å·²æ¸…ç©º")

# ç¤ºä¾‹è°ƒç”¨
# clear_rows_from_fifth("ä½ çš„excelæ–‡ä»¶è·¯å¾„.xlsx")





try:
    move_file(file_c, folder_d)
except Exception as e:
    print("[Error in move_file]:", e)

try:
    move_folder(src_folder, dst_folder)
except Exception as e:
    print("[Error in move_folder]:", e)




import shutil
from pathlib import Path
from datetime import datetime, timedelta

# ========= æ—¥ä»˜å–å¾— =========
def get_last_thursday():
    """å…ˆé€±ã®æœ¨æ›œæ—¥ã®æ—¥ä»˜ (yyyymmdd) ã‚’è¿”ã™"""
    today = datetime.today()
    # weekday(): æœˆ=0, ç«=1, ..., æ—¥=6 / æœ¨=3
    days_since_thu = (today.weekday() - 3) % 7
    last_thu = today - timedelta(days=days_since_thu + 7)
    return last_thu.strftime("%Y%m%d")

# ========= ãƒ•ã‚¡ã‚¤ãƒ«ç§»å‹•ï¼ˆ2å¼•æ•°ã ã‘ï¼‰ =========
def move_file(file_path, dst_folder):
    """file_path ã‚’ dst_folder ã¸ç§»å‹•ã™ã‚‹ï¼ˆdst_folder ãŒç„¡ã‘ã‚Œã°ä½œæˆï¼‰"""
    file_path = Path(file_path)
    dst_folder = Path(dst_folder)

    if not file_path.is_file():
        raise FileNotFoundError(f"ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: {file_path}")

    dst_folder.mkdir(parents=True, exist_ok=True)  # ç›®çš„ãƒ•ã‚©ãƒ«ãƒ€ã‚’ç”¨æ„
    shutil.move(str(file_path), str(dst_folder))
    print(f"[OK] {file_path} â†’ {dst_folder}")

# ========= ãƒ•ã‚©ãƒ«ãƒ€ç§»å‹•ï¼ˆ2å¼•æ•°ã ã‘ï¼‰ =========
def move_folder(src_folder, dst_folder):
    """
    src_folder ã‚’ dst_folder ã¸ç§»å‹•ã™ã‚‹ã€‚
    - ã‚‚ã— dst_folder ãŒæ—¢ã«å­˜åœ¨ã™ã‚‹å ´åˆã¯ã€src_folder ã‚’ãã®â€œä¸­â€ã¸ç§»å‹•ï¼ˆä¾‹: B/20250814ï¼‰
    - ã¾ã ç„¡ã„å ´åˆã¯ dst_folder ã‚’æ–°è¦ä½œæˆã—ã¦ç§»å‹•
    """
    src_folder = Path(src_folder)
    dst_folder = Path(dst_folder)

    if not src_folder.exists():
        raise FileNotFoundError(f"ãƒ•ã‚©ãƒ«ãƒ€ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: {src_folder}")

    # dst_folder ãŒæ—¢ã«å­˜åœ¨ã™ã‚‹ãªã‚‰ã€ãã®ä¸­ã« src ã®åå‰ã§ç§»å‹•ã™ã‚‹
    if dst_folder.exists():
        final_dst = dst_folder / src_folder.name
    else:
        # å­˜åœ¨ã—ãªã„ãªã‚‰ã€è¦ªã ã‘ç”¨æ„ã—ã¦ã‹ã‚‰ãã®å ´æ‰€ã¸ç§»å‹•
        dst_folder.parent.mkdir(parents=True, exist_ok=True)
        final_dst = dst_folder

    # æœ€çµ‚è¡Œãå…ˆãŒæ—¢ã«å­˜åœ¨ã—ã¦ã„ãŸã‚‰è¡çªãªã®ã§ã‚¨ãƒ©ãƒ¼
    if final_dst.exists():
        raise FileExistsError(f"ç§»å‹•å…ˆãŒæ—¢ã«å­˜åœ¨ã—ã¾ã™: {final_dst}")

    shutil.move(str(src_folder), str(final_dst))
    print(f"[OK] {src_folder} â†’ {final_dst}")

# ========= å¤‰æ•°å®šç¾©ï¼ˆé•·ã„ãƒ‘ã‚¹ã¯å…¨éƒ¨ã“ã“ã§ï¼‰ =========
base_dir   = Path(r"Z:\box\ab")         # ãƒ™ãƒ¼ã‚¹ãƒ•ã‚©ãƒ«ãƒ€ï¼ˆé•·ã„ãªã‚‰ã“ã“ã§ä¸€ç™ºã§ç®¡ç†ï¼‰
date_str   = get_last_thursday()        # å…ˆé€±æœ¨æ›œ yyyymmdd

# ãƒ•ã‚¡ã‚¤ãƒ«: cYYYYMMDD.txt â†’ d ãƒ•ã‚©ãƒ«ãƒ€
file_c     = base_dir / f"c{date_str}.txt"
folder_d   = base_dir / "d"

# ãƒ•ã‚©ãƒ«ãƒ€: YYYYMMDD â†’ Bï¼ˆB ãŒå­˜åœ¨ã™ã‚‹ãªã‚‰ B\YYYYMMDD ã«å…¥ã‚Œã‚‹ï¼‰
src_folder = base_dir / date_str
dst_folder = base_dir / "B"

# ========= å®Ÿè¡Œä¾‹ =========
move_file(file_c, folder_d)         # ä¾‹: Z:\box\ab\c20250814.txt â†’ Z:\box\ab\d
move_folder(src_folder, dst_folder) # ä¾‹: Z:\box\ab\20250814   â†’ Z:\box\ab\B\20250814

import shutil
from pathlib import Path
from datetime import datetime, timedelta

# ========= æ—¥ä»˜å–å¾— =========
def get_last_thursday():
    """å…ˆé€±ã®æœ¨æ›œæ—¥ã®æ—¥ä»˜ (yyyymmdd) ã‚’è¿”ã™"""
    today = datetime.today()
    # weekday(): æœˆ=0, ç«=1, ..., æ—¥=6 / æœ¨=3
    days_since_thu = (today.weekday() - 3) % 7
    last_thu = today - timedelta(days=days_since_thu + 7)
    return last_thu.strftime("%Y%m%d")

# ========= ãƒ•ã‚¡ã‚¤ãƒ«ç§»å‹•ï¼ˆ2å¼•æ•°ã ã‘ï¼‰ =========
def move_file(file_path, dst_folder):
    """file_path ã‚’ dst_folder ã¸ç§»å‹•ã™ã‚‹ï¼ˆdst_folder ãŒç„¡ã‘ã‚Œã°ä½œæˆï¼‰"""
    file_path = Path(file_path)
    dst_folder = Path(dst_folder)

    if not file_path.is_file():
        raise FileNotFoundError(f"ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: {file_path}")

    dst_folder.mkdir(parents=True, exist_ok=True)  # ç›®çš„ãƒ•ã‚©ãƒ«ãƒ€ã‚’ç”¨æ„
    shutil.move(str(file_path), str(dst_folder))
    print(f"[OK] {file_path} â†’ {dst_folder}")

# ========= ãƒ•ã‚©ãƒ«ãƒ€ç§»å‹•ï¼ˆ2å¼•æ•°ã ã‘ï¼‰ =========
def move_folder(src_folder, dst_folder):
    """
    src_folder ã‚’ dst_folder ã¸ç§»å‹•ã™ã‚‹ã€‚
    - ã‚‚ã— dst_folder ãŒæ—¢ã«å­˜åœ¨ã™ã‚‹å ´åˆã¯ã€src_folder ã‚’ãã®â€œä¸­â€ã¸ç§»å‹•ï¼ˆä¾‹: B/20250814ï¼‰
    - ã¾ã ç„¡ã„å ´åˆã¯ dst_folder ã‚’æ–°è¦ä½œæˆã—ã¦ç§»å‹•
    """
    src_folder = Path(src_folder)
    dst_folder = Path(dst_folder)

    if not src_folder.exists():
        raise FileNotFoundError(f"ãƒ•ã‚©ãƒ«ãƒ€ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: {src_folder}")

    # dst_folder ãŒæ—¢ã«å­˜åœ¨ã™ã‚‹ãªã‚‰ã€ãã®ä¸­ã« src ã®åå‰ã§ç§»å‹•ã™ã‚‹
    if dst_folder.exists():
        final_dst = dst_folder / src_folder.name
    else:
        # å­˜åœ¨ã—ãªã„ãªã‚‰ã€è¦ªã ã‘ç”¨æ„ã—ã¦ã‹ã‚‰ãã®å ´æ‰€ã¸ç§»å‹•
        dst_folder.parent.mkdir(parents=True, exist_ok=True)
        final_dst = dst_folder

    # æœ€çµ‚è¡Œãå…ˆãŒæ—¢ã«å­˜åœ¨ã—ã¦ã„ãŸã‚‰è¡çªãªã®ã§ã‚¨ãƒ©ãƒ¼
    if final_dst.exists():
        raise FileExistsError(f"ç§»å‹•å…ˆãŒæ—¢ã«å­˜åœ¨ã—ã¾ã™: {final_dst}")

    shutil.move(str(src_folder), str(final_dst))
    print(f"[OK] {src_folder} â†’ {final_dst}")

# ========= å¤‰æ•°å®šç¾©ï¼ˆé•·ã„ãƒ‘ã‚¹ã¯å…¨éƒ¨ã“ã“ã§ï¼‰ =========
base_dir   = Path(r"Z:\box\ab")         # ãƒ™ãƒ¼ã‚¹ãƒ•ã‚©ãƒ«ãƒ€ï¼ˆé•·ã„ãªã‚‰ã“ã“ã§ä¸€ç™ºã§ç®¡ç†ï¼‰
date_str   = get_last_thursday()        # å…ˆé€±æœ¨æ›œ yyyymmdd

# ãƒ•ã‚¡ã‚¤ãƒ«: cYYYYMMDD.txt â†’ d ãƒ•ã‚©ãƒ«ãƒ€
file_c     = base_dir / f"c{date_str}.txt"
folder_d   = base_dir / "d"

# ãƒ•ã‚©ãƒ«ãƒ€: YYYYMMDD â†’ Bï¼ˆB ãŒå­˜åœ¨ã™ã‚‹ãªã‚‰ B\YYYYMMDD ã«å…¥ã‚Œã‚‹ï¼‰
src_folder = base_dir / date_str
dst_folder = base_dir / "B"

# ========= å®Ÿè¡Œä¾‹ =========
move_file(file_c, folder_d)         # ä¾‹: Z:\box\ab\c20250814.txt â†’ Z:\box\ab\d
move_folder(src_folder, dst_folder) # ä¾‹: Z:\box\ab\20250814   â†’ Z:\box\ab\B\20250814




import shutil
import os
from datetime import datetime, timedelta

# ========= æ—¥ä»˜å–å¾— =========
def get_last_thursday():
    """å…ˆé€±ã®æœ¨æ›œæ—¥ã®æ—¥ä»˜ (yyyymmdd) ã‚’è¿”ã™"""
    today = datetime.today()
    days_since_thursday = (today.weekday() - 3) % 7  # 3ã¯æœ¨æ›œ
    last_thursday = today - timedelta(days=days_since_thursday + 7)
    return last_thursday.strftime("%Y%m%d")

# ========= ãƒ•ã‚¡ã‚¤ãƒ«ç§»å‹• =========
def move_file(file_path, dst_folder):
    """ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç§»å‹•ã™ã‚‹"""
    if not os.path.isfile(file_path):
        raise FileNotFoundError(f"ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã—ã¾ã›ã‚“: {file_path}")
    if not os.path.exists(dst_folder):
        os.makedirs(dst_folder)
    shutil.move(file_path, dst_folder)
    print(f"[OK] {file_path} â†’ {dst_folder}")

# ========= ãƒ•ã‚©ãƒ«ãƒ€ç§»å‹• =========
def move_folder(src_folder, dst_folder):
    """ãƒ•ã‚©ãƒ«ãƒ€ã‚’ç§»å‹•ã™ã‚‹"""
    if not os.path.exists(src_folder):
        raise FileNotFoundError(f"ãƒ•ã‚©ãƒ«ãƒ€ãŒå­˜åœ¨ã—ã¾ã›ã‚“: {src_folder}")
    if os.path.exists(dst_folder):
        raise FileExistsError(f"ç›®çš„ãƒ•ã‚©ãƒ«ãƒ€ãŒæ—¢ã«å­˜åœ¨ã—ã¾ã™: {dst_folder}")
    shutil.move(src_folder, dst_folder)
    print(f"[OK] {src_folder} â†’ {dst_folder}")

# ========= å¤‰æ•°å®šç¾© =========
base_dir   = r"Z:\box\ab"           # ãƒ™ãƒ¼ã‚¹ãƒ•ã‚©ãƒ«ãƒ€
date_str   = get_last_thursday()    # å…ˆé€±æœ¨æ›œã®æ—¥ä»˜

file_c     = os.path.join(base_dir, f"c{date_str}.txt")  # cYYYYMMDD.txt
folder_d   = os.path.join(base_dir, "d")                 # d ãƒ•ã‚©ãƒ«ãƒ€

src_folder = os.path.join(base_dir, date_str)            # YYYYMMDD ãƒ•ã‚©ãƒ«ãƒ€
dst_folder = os.path.join(base_dir, "B")                 # B ãƒ•ã‚©ãƒ«ãƒ€

# ========= å®Ÿè¡Œ =========
move_file(file_c, folder_d)       # ãƒ•ã‚¡ã‚¤ãƒ«ç§»å‹•
move_folder(src_folder, dst_folder)  # ãƒ•ã‚©ãƒ«ãƒ€ç§»å‹•








import shutil
import os

def move_folder(src: str, dst: str):
    """
    ç§»åŠ¨æ–‡ä»¶å¤¹ä» src åˆ° dstã€‚
    """
    if not os.path.exists(src):
        raise FileNotFoundError(f"æºæ–‡ä»¶å¤¹ä¸å­˜åœ¨: {src}")

    if os.path.exists(dst):
        raise FileExistsError(f"ç›®æ ‡æ–‡ä»¶å¤¹å·²å­˜åœ¨: {dst}")

    shutil.move(src, dst)
    print(f"å·²æˆåŠŸç§»åŠ¨ {src} åˆ° {dst}")


# ç”¨å˜é‡å­˜æ”¾è·¯å¾„
src_path = r"Z:\box\ab\A"
dst_path = r"Z:\box\ab\B"

# è°ƒç”¨æ–¹æ³•
move_folder(src_path, dst_path)







# é–‹ã„ã¦ã„ãŸå ´åˆã¯é–‰ã˜ã‚‹
for wb in excel.Workbooks:
    if wb.Name.lower() == "merged_all.xlsx":
        wb.Close(False)

# å°‘ã—å¾…ã¤ï¼ˆãƒ•ã‚¡ã‚¤ãƒ«ãƒãƒ³ãƒ‰ãƒ«è§£æ”¾ã®ãŸã‚ï¼‰
time.sleep(1)

# ä¿å­˜
wb_dst.SaveAs(dst_path)




try:
    wb_dst.Sheets(wb_dst.Sheets.Count).Name = original_name
except Exception as e:
    print(f"âš ï¸ ã‚·ãƒ¼ãƒˆå \"{original_name}\" ã‚’è¨­å®šã§ãã¾ã›ã‚“: {e}")
import win32com.client as win32
import os

# === ã‚½ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã®è¨­å®š ===
source_folder = "sources"  # Excelãƒ•ã‚¡ã‚¤ãƒ«ã‚’å…¥ã‚Œã‚‹ãƒ•ã‚©ãƒ«ãƒ€
file_names = ["aaa.xlsx", "bbb.xlsx", "ccc.xlsx"]  # å„ãƒ•ã‚¡ã‚¤ãƒ«ã«1ã¤ã®ã‚·ãƒ¼ãƒˆã®ã¿ï¼ˆã‚·ãƒ¼ãƒˆåï¼ãƒ•ã‚¡ã‚¤ãƒ«åï¼‰

# === å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ ===
dst_path = os.path.abspath(os.path.join(source_folder, "merged_all.xlsx"))

# âœ… å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«ãŒã™ã§ã«å­˜åœ¨ã™ã‚‹å ´åˆã¯å‰Šé™¤ï¼ˆä¸Šæ›¸ãç¢ºèªã‚’å›é¿ï¼‰
if os.path.exists(dst_path):
    os.remove(dst_path)

# âœ… Excelã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’èµ·å‹•
excel = win32.gencache.EnsureDispatch("Excel.Application")
excel.Visible = True               # ğŸªŸ Excelã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’è¡¨ç¤ºï¼ˆãƒ‡ãƒãƒƒã‚°ç”¨ï¼‰
excel.DisplayAlerts = False        # âš ï¸ ä¸Šæ›¸ãç¢ºèªãªã©ã®ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’éè¡¨ç¤º

# âœ… ç©ºã®Excelãƒ–ãƒƒã‚¯ã‚’æ–°è¦ä½œæˆã—ã€ä¸€åº¦ä¿å­˜ï¼ˆä¿å­˜ã—ãªã„ã¨ã‚·ãƒ¼ãƒˆã®ã‚³ãƒ”ãƒ¼ãŒã§ããªã„ï¼‰
wb_dst = excel.Workbooks.Add()
wb_dst.SaveAs(dst_path)

# âœ… å„ã‚½ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚·ãƒ¼ãƒˆã‚’é †ç•ªã«ã‚³ãƒ”ãƒ¼
for file_name in file_names:
    src_path = os.path.abspath(os.path.join(source_folder, file_name))
    print(f"ğŸ“¥ ã‚³ãƒ”ãƒ¼ä¸­: {file_name}")

    # å…ƒãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ã
    wb_src = excel.Workbooks.Open(src_path)
    sheet = wb_src.Sheets(1)  # æœ€åˆã®ã‚·ãƒ¼ãƒˆã‚’å–å¾—ï¼ˆ1ã¤ã—ã‹ãªã„æƒ³å®šï¼‰
    original_name = sheet.Name  # å…ƒã®ã‚·ãƒ¼ãƒˆåã‚’ä¿æŒ

    # ã‚·ãƒ¼ãƒˆã‚’å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã®æœ€å¾Œã«ã‚³ãƒ”ãƒ¼
    sheet.Copy(After=wb_dst.Sheets(wb_dst.Sheets.Count))

    # ã‚³ãƒ”ãƒ¼ã•ã‚ŒãŸã‚·ãƒ¼ãƒˆï¼ˆæœ€å¾Œå°¾ï¼‰ã«å…ƒã®ã‚·ãƒ¼ãƒˆåã‚’ã¤ã‘ã‚‹
    try:
        wb_dst.Sheets(wb_dst.Sheets.Count).Name = original_name
    except Exception:
        print(f"âš ï¸ ã‚·ãƒ¼ãƒˆå \"{original_name}\" ã¯ç„¡åŠ¹ãªæ–‡å­—ã‚’å«ã‚€ã‹é•·ã™ãã¾ã™")

    # å…ƒãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¿å­˜ã›ãšã«é–‰ã˜ã‚‹
    wb_src.Close(False)

# âœ… å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¿å­˜ã—ã¦é–‰ã˜ã‚‹
wb_dst.Save()
wb_dst.Close()
excel.Quit()

print(f"âœ… çµåˆå®Œäº†ï¼šä¿å­˜å…ˆ â†’ {dst_path}")







import win32com.client as win32
import os

# === ãƒ‘ã‚¹ã®è¨­å®š ===
source_folder = "sources"
src_path = os.path.abspath(os.path.join(source_folder, "sample.xlsx"))       # ã‚³ãƒ”ãƒ¼å…ƒã®Excelãƒ•ã‚¡ã‚¤ãƒ«
dst_path = os.path.abspath(os.path.join(source_folder, "merged_test.xlsx"))  # å‡ºåŠ›å…ˆã®Excelãƒ•ã‚¡ã‚¤ãƒ«

# âœ… æ—¢ã«å‡ºåŠ›å…ˆãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã™ã‚‹å ´åˆã€ä¸Šæ›¸ãç¢ºèªã‚’é¿ã‘ã‚‹ãŸã‚å‰Šé™¤ã™ã‚‹
if os.path.exists(dst_path):
    os.remove(dst_path)

# âœ… Excelã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’èµ·å‹•
excel = win32.gencache.EnsureDispatch("Excel.Application")
excel.Visible = True               # âœ… Excelã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’è¡¨ç¤ºï¼ˆãƒ‡ãƒãƒƒã‚°ç”¨ï¼‰
excel.DisplayAlerts = False        # âœ… ä¸Šæ›¸ãä¿å­˜ãªã©ã®è­¦å‘Šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã—ãªã„

# âœ… ã‚³ãƒ”ãƒ¼å…ƒã®Excelãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ã
wb_src = excel.Workbooks.Open(src_path)
sheet = wb_src.Sheets(1)           # âœ… æœ€åˆã®ã‚·ãƒ¼ãƒˆã‚’å–å¾—

# âœ… æ–°ã—ã„ç©ºç™½ã®Excelãƒ–ãƒƒã‚¯ã‚’ä½œæˆã—ã€å‡ºåŠ›å…ˆã¨ã—ã¦ä¿å­˜
wb_dst = excel.Workbooks.Add()
wb_dst.SaveAs(dst_path)            # âœ… äº‹å‰ã«ä¿å­˜ã—ã¦ãŠã‹ãªã„ã¨ã‚·ãƒ¼ãƒˆã‚³ãƒ”ãƒ¼ãŒå‹•ä½œã—ãªã„

# âœ… ã‚·ãƒ¼ãƒˆã‚’ã‚³ãƒ”ãƒ¼ï¼ˆå‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã®æœ€å¾Œã«è¿½åŠ ï¼‰
sheet.Copy(After=wb_dst.Sheets(wb_dst.Sheets.Count))

# âœ… ã‚³ãƒ”ãƒ¼å…ƒã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¿å­˜ã›ãšã«é–‰ã˜ã‚‹
wb_src.Close(False)

# âœ… å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¿å­˜ã—ã¦é–‰ã˜ã‚‹
wb_dst.Save()
wb_dst.Close()

# âœ… Excelã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’çµ‚äº†
excel.Quit()

print("âœ… ã‚·ãƒ¼ãƒˆã®ã‚³ãƒ”ãƒ¼å®Œäº†ï¼ä¿å­˜å…ˆï¼š", dst_path)


import os
import win32com.client as win32
from glob import glob

# === è¨­å®š ===
source_folder = "sources"  # Excelãƒ•ã‚¡ã‚¤ãƒ«ã‚’å…¥ã‚Œã¦ãŠããƒ•ã‚©ãƒ«ãƒ€
output_file = "merged_final.xlsx"
output_path = os.path.abspath(os.path.join(source_folder, output_file))

# === æ—¢ã«ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã™ã‚‹å ´åˆã¯å‰Šé™¤ ===
if os.path.exists(output_path):
    os.remove(output_path)

# === ãƒãƒ¼ã‚¸å¯¾è±¡ã®Excelãƒ•ã‚¡ã‚¤ãƒ«ã‚’å–å¾— ===
excel_files = [
    f for f in glob(os.path.join(source_folder, "*.xlsx"))
    if not f.endswith(output_file) and not os.path.basename(f).startswith("~$")
]

# === Excelã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’èµ·å‹• ===
excel = win32.gencache.EnsureDispatch("Excel.Application")
excel.DisplayAlerts = False        # ğŸ”• è­¦å‘Šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã—ãªã„
excel.Visible = False              # ğŸªŸ éè¡¨ç¤ºã§å®Ÿè¡Œ

# === ç©ºã®Excelãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¦ä¿å­˜ï¼ˆä¿å­˜ã—ãªã„ã¨Copyã§ããªã„ï¼‰ ===
wb_target = excel.Workbooks.Add()
wb_target.SaveAs(output_path)

print(f"ğŸ“ çµ±åˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆï¼š{output_path}")

# === å„Excelãƒ•ã‚¡ã‚¤ãƒ«ã®æœ€åˆã®ã‚·ãƒ¼ãƒˆã‚’ã‚³ãƒ”ãƒ¼ ===
for file_path in excel_files:
    abs_path = os.path.abspath(file_path)
    file_name = os.path.splitext(os.path.basename(file_path))[0]

    print(f"ğŸ“¥ ã‚³ãƒ”ãƒ¼ä¸­: {file_name}")

    wb_source = excel.Workbooks.Open(abs_path)
    sheet_to_copy = wb_source.Sheets(1)  # æœ€åˆã®ã‚·ãƒ¼ãƒˆã‚’å–å¾—
    sheet_to_copy.Copy(After=wb_target.Sheets(wb_target.Sheets.Count))  # æœ€å¾Œã«ã‚³ãƒ”ãƒ¼
    wb_source.Close(False)

    # ã‚³ãƒ”ãƒ¼ã•ã‚ŒãŸã‚·ãƒ¼ãƒˆã‚’ãƒªãƒãƒ¼ãƒ 
    try:
        wb_target.Sheets(wb_target.Sheets.Count).Name = file_name[:31]
    except Exception:
        print(f"âš ï¸ ã‚·ãƒ¼ãƒˆå \"{file_name}\" ã¯ç„¡åŠ¹ãªæ–‡å­—ã‚’å«ã‚€å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚")

# === ç©ºç™½ã‚·ãƒ¼ãƒˆãŒã¾ã æ®‹ã£ã¦ã„ã‚Œã°å‰Šé™¤ ===
if wb_target.Sheets.Count > len(excel_files):
    try:
        for sheet in wb_target.Sheets:
            if sheet.UsedRange.Count == 1 and not sheet.UsedRange.Value:
                sheet.Delete()
    except:
        pass  # å‰Šé™¤ã«å¤±æ•—ã—ã¦ã‚‚ç„¡è¦–

# === ä¿å­˜ã—ã¦çµ‚äº† ===
wb_target.Save()
wb_target.Close()
excel.Quit()

print(f"\nâœ… å®Œäº†ï¼šã™ã¹ã¦ã®ã‚·ãƒ¼ãƒˆã‚’çµ±åˆã—ä¿å­˜ã—ã¾ã—ãŸ â†’ {output_path}")





import win32com.client as win32
import os

excel = win32.gencache.EnsureDispatch("Excel.Application")
excel.Visible = True  # è¿™æ¬¡è®©å®ƒå¯è§ï¼Œæ–¹ä¾¿è°ƒè¯•

# ä¿®æ”¹æˆä½ å®é™…çš„æ–‡ä»¶è·¯å¾„
src_path = os.path.abspath("sources/sample.xlsx")
dst_path = os.path.abspath("sources/merged_test.xlsx")

# æ‰“å¼€æºæ–‡ä»¶
wb_src = excel.Workbooks.Open(src_path)
sheet = wb_src.Sheets(1)

# æ–°å»ºç©ºç™½ç›®æ ‡æ–‡ä»¶
wb_dst = excel.Workbooks.Add()
wb_dst.SaveAs(dst_path)

# å¤åˆ¶ sheet åˆ°ç›®æ ‡æ–‡ä»¶ä¸­
sheet.Copy(After=wb_dst.Sheets(wb_dst.Sheets.Count))

# å…³é—­å¹¶ä¿å­˜
wb_src.Close(False)
wb_dst.Save()
wb_dst.Close()
excel.Quit()

print("âœ… æµ‹è¯•å®Œæˆ")





import os
import win32com.client as win32
from glob import glob

# === è¨­å®š ===
source_folder = "sources"  # çµ±åˆã—ãŸã„Excelãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¿å­˜ã™ã‚‹ãƒ•ã‚©ãƒ«ãƒ€
output_file = "merged_final.xlsx"  # å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«å
output_path = os.path.abspath(os.path.join(source_folder, output_file))  # å‡ºåŠ›ãƒ‘ã‚¹

# === ãƒãƒ¼ã‚¸å¯¾è±¡ã®Excelãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã™ã¹ã¦å–å¾— ===
excel_files = [
    f for f in glob(os.path.join(source_folder, "*.xlsx"))
    if not f.endswith(output_file) and not os.path.basename(f).startswith("~$")
]

# === Excelã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’èµ·å‹• ===
excel = win32.gencache.EnsureDispatch("Excel.Application")
excel.DisplayAlerts = False  # ä¸Šæ›¸ãç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’éè¡¨ç¤º
excel.Visible = False        # Excelã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’è¡¨ç¤ºã—ãªã„

# === æ–°ã—ã„ç©ºã®Excelãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆï¼ˆå…ˆã«ä¿å­˜ãŒå¿…è¦ï¼‰===
wb_target = excel.Workbooks.Add()
wb_target.SaveAs(output_path)

print(f"ğŸ“ ç©ºã®ãƒãƒ¼ã‚¸ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã—ãŸï¼š{output_path}")

# === å„ãƒ•ã‚¡ã‚¤ãƒ«ã®æœ€åˆã®ã‚·ãƒ¼ãƒˆã‚’ã‚³ãƒ”ãƒ¼é–‹å§‹ ===
for file_path in excel_files:
    abs_path = os.path.abspath(file_path)
    file_name = os.path.splitext(os.path.basename(file_path))[0]  # æ‹¡å¼µå­ãªã—ãƒ•ã‚¡ã‚¤ãƒ«å

    print(f"ğŸ“¥ ã‚³ãƒ”ãƒ¼ä¸­: {file_name} ...")

    wb_source = excel.Workbooks.Open(abs_path)  # å…ƒãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ã
    sheet_to_copy = wb_source.Sheets(1)         # æœ€åˆã®ã‚·ãƒ¼ãƒˆã‚’å–å¾—
    sheet_to_copy.Copy(Before=wb_target.Sheets(1))  # æ–°ã—ã„ãƒ–ãƒƒã‚¯ã®å…ˆé ­ã«ã‚³ãƒ”ãƒ¼
    wb_source.Close(False)  # å…ƒãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¿å­˜ã›ãšã«é–‰ã˜ã‚‹

    # ã‚³ãƒ”ãƒ¼ã•ã‚ŒãŸã‚·ãƒ¼ãƒˆã‚’ãƒ•ã‚¡ã‚¤ãƒ«åã§ãƒªãƒãƒ¼ãƒ ï¼ˆæœ€å¤§31æ–‡å­—ã¾ã§ï¼‰
    try:
        wb_target.Sheets(1).Name = file_name[:31]
    except Exception:
        print(f"âš ï¸ ã‚·ãƒ¼ãƒˆå \"{file_name}\" ã¯ä¸æ­£ãªæ–‡å­—ãŒå«ã¾ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ãƒªãƒãƒ¼ãƒ å¤±æ•—")

# === ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ç©ºç™½ã‚·ãƒ¼ãƒˆã‚’å‰Šé™¤ï¼ˆã‚‚ã—å­˜åœ¨ã™ã‚Œã°ï¼‰===
if wb_target.Sheets.Count > len(excel_files):
    try:
        for sheet in wb_target.Sheets:
            if sheet.UsedRange.Count == 1 and not sheet.UsedRange.Value:
                sheet.Delete()
    except:
        pass  # å‰Šé™¤ã«å¤±æ•—ã—ã¦ã‚‚ç„¡è¦–

# === ä¿å­˜ã—ã¦Excelã‚’çµ‚äº† ===
wb_target.Save()
wb_target.Close()
excel.Quit()

print(f"\nâœ… çµ±åˆå®Œäº†ï¼å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«ï¼š{output_path}")




import os
import pandas as pd
from openpyxl import Workbook, load_workbook

# === 1. é…ç½®è·¯å¾„ ===
source_file = "source.xlsx"           # æºæ–‡ä»¶è·¯å¾„
source_sheet = "SheetA"               # æº sheet å

folder_path = "folderA"               # è¦åˆ›å»ºçš„æ–‡ä»¶å¤¹
target_file_name = "target.xlsx"      # ç›®æ ‡æ–‡ä»¶å
target_sheet_name = "com"             # è¦å†™å…¥çš„ç›®æ ‡ sheet å

# === 2. åˆ›å»ºç›®æ ‡æ–‡ä»¶å¤¹å’Œç©º Excel æ–‡ä»¶ ===
os.makedirs(folder_path, exist_ok=True)
target_file_path = os.path.join(folder_path, target_file_name)

if not os.path.exists(target_file_path):
    wb = Workbook()
    wb.save(target_file_path)
    print(f"ğŸ“ å·²åˆ›å»ºç©ºç™½ Excel æ–‡ä»¶ï¼š{target_file_path}")
else:
    print(f"ğŸ“ æ–‡ä»¶å·²å­˜åœ¨ï¼Œå°†åœ¨å…¶ä¸Šæ·»åŠ  sheetï¼š{target_file_path}")

# === 3. è¯»å–æºæ–‡ä»¶çš„ SheetA æ•°æ®ï¼ˆåªæ•°æ®ä¸æ ¼å¼ï¼‰ ===
df = pd.read_excel(source_file, sheet_name=source_sheet)

# === 4. æ‰“å¼€ç›®æ ‡ Excel å¹¶å†™å…¥æ–°çš„ sheet "com" ===
book = load_workbook(target_file_path)
with pd.ExcelWriter(target_file_path, engine='openpyxl', mode='a') as writer:
    writer.book = book

    # å¦‚æœå·²å­˜åœ¨åŒå sheetï¼Œå…ˆåˆ é™¤å®ƒ
    if target_sheet_name in book.sheetnames:
        del book[target_sheet_name]
    
    df.to_excel(writer, sheet_name=target_sheet_name, index=False)

print(f"âœ… æˆåŠŸå°† `{source_sheet}` çš„å†…å®¹å¤åˆ¶ä¸º `{target_sheet_name}` å†™å…¥ `{target_file_path}`")





import requests
import urllib.parse
import os

# === é…ç½® ===
project_id = 20
branch_name = "demo/table"
file_path = "port/table/docs/ccc.md"  # GitLab ä¸­çš„å®Œæ•´è·¯å¾„
token = "ä½ çš„TOKEN"
base_url = "https://aaa-aaa-viewer.rmb-ccc.jp"

# ä½ è¦ä¿å­˜çš„ç›®æ ‡ç›®å½•ï¼ˆç¡®ä¿å­˜åœ¨æˆ–å¯å†™ï¼‰
save_dir = "D:/GitLabDownloads/"

# URL è½¬ä¹‰
encoded_branch = urllib.parse.quote(branch_name, safe='')
encoded_path = urllib.parse.quote(file_path, safe='')

# æ‹¼ API URL
api_url = f"{base_url}/api/v4/projects/{project_id}/repository/files/{encoded_path}/raw?ref={encoded_branch}"
headers = {"PRIVATE-TOKEN": token}

print(f"ğŸ”— ä¸‹è½½é“¾æ¥: {api_url}")

# è¯·æ±‚ä¸‹è½½
resp = requests.get(api_url, headers=headers)

if resp.status_code == 200:
    # åªå–æœ€åæ–‡ä»¶å
    filename = os.path.basename(file_path)
    local_path = os.path.join(save_dir, filename)

    # ä¿å­˜
    with open(local_path, "wb") as f:
        f.write(resp.content)
    print(f"âœ… ä¸‹è½½å®Œæˆ: {local_path}")
else:
    print(f"âŒ ä¸‹è½½å¤±è´¥: {resp.status_code}")
    print(resp.text)

import requests
import urllib.parse

# ============ ä½ çš„å‚æ•° ============
project_id = 20
branch_name = "demo/table"  # è¿™ä¸ªåˆ†æ”¯åæœ‰ '/', API éœ€è¦ URL Encode
file_path = "port/table/xxx/yyy/target.md"  # è¿™é‡Œæ¢æˆä½ æœ€ç»ˆç¡®å®šçš„è·¯å¾„
token = "ä½ çš„TOKEN"
base_url = "https://aaa-aaa-viewer.rmb-ccc.jp"

# ============ è‡ªåŠ¨ URL è½¬ä¹‰ ============
encoded_branch = urllib.parse.quote(branch_name, safe='')
encoded_path = urllib.parse.quote(file_path, safe='')

# API URL
api_url = f"{base_url}/api/v4/projects/{project_id}/repository/files/{encoded_path}/raw?ref={encoded_branch}"
headers = {"PRIVATE-TOKEN": token}

print(f"ğŸ”— ä¸‹è½½é“¾æ¥: {api_url}")

# è¯·æ±‚ä¸‹è½½
resp = requests.get(api_url, headers=headers)

if resp.status_code == 200:
    # ä¿å­˜æ–‡ä»¶
    local_filename = file_path.split("/")[-1]  # è‡ªåŠ¨å–æœ€åçš„æ–‡ä»¶å
    with open(local_filename, "wb") as f:
        f.write(resp.content)
    print(f"âœ… ä¸‹è½½å®Œæˆ: {local_filename}")
else:
    print(f"âŒ ä¸‹è½½å¤±è´¥: {resp.status_code}")
    print(resp.text)



import requests

# === GitLab é…ç½® ===
GITLAB_URL = "https://aaa-aaa-viewer.rmb-ccc.jp"
PROJECT_ID = 20
ACCESS_TOKEN = "ä½ çš„TOKEN"

# åªåˆ—å‡ºåˆ†æ”¯åé‡ŒåŒ…å«è¿™ä¸ªå‰ç¼€çš„
BRANCH_PREFIX = "demo/table"

headers = {"PRIVATE-TOKEN": ACCESS_TOKEN}

def get_branches():
    """åˆ—å‡ºé¡¹ç›®çš„æ‰€æœ‰åˆ†æ”¯ï¼Œå¹¶è¿‡æ»¤ demo/table å‰ç¼€"""
    url = f"{GITLAB_URL}/api/v4/projects/{PROJECT_ID}/repository/branches"
    resp = requests.get(url, headers=headers)
    if resp.status_code == 200:
        branches = resp.json()
        filtered = [b["name"] for b in branches if b["name"].startswith(BRANCH_PREFIX)]
        print(f"âœ… æ‰¾åˆ° {len(filtered)} ä¸ªåˆ†æ”¯ï¼Œå‰ç¼€æ˜¯ `{BRANCH_PREFIX}`:\n")
        for name in filtered:
            print(f"- {name}")
    else:
        print(f"âŒ è·å–åˆ†æ”¯å¤±è´¥ {resp.status_code}")
        print(resp.text)

if __name__ == "__main__":
    get_branches()



import requests

# === GitLab é…ç½® ===
GITLAB_URL = "https://aaa-aaa-viewer.rmb-ccc.jp"
PROJECT_ID = 59
ACCESS_TOKEN = "ä½ çš„TOKEN"

TARGET_KEYWORD = "demon"   # åªæ‰¾åŒ…å« demon çš„è·¯å¾„

headers = {"PRIVATE-TOKEN": ACCESS_TOKEN}

def get_branches():
    url = f"{GITLAB_URL}/api/v4/projects/{PROJECT_ID}/repository/branches"
    resp = requests.get(url, headers=headers)
    resp.raise_for_status()
    return [b["name"] for b in resp.json()]

def list_files(ref):
    url = f"{GITLAB_URL}/api/v4/projects/{PROJECT_ID}/repository/tree"
    params = {"ref": ref, "recursive": True, "per_page": 100}
    resp = requests.get(url, headers=headers, params=params)
    resp.raise_for_status()
    return resp.json()

def scan_demon_files():
    branches = get_branches()
    print(f"âœ… å‘ç° {len(branches)} ä¸ªåˆ†æ”¯ï¼Œå¼€å§‹æ‰«æåŒ…å« `{TARGET_KEYWORD}` çš„æ–‡ä»¶...\n")

    found_files = []

    for branch in branches:
        print(f"ğŸ” æ­£åœ¨æ‰«æåˆ†æ”¯: {branch}")
        try:
            files = list_files(branch)
            for f in files:
                if f["type"] == "blob" and TARGET_KEYWORD in f["path"]:
                    found_files.append((branch, f["path"]))
        except Exception as e:
            print(f"âš ï¸ åˆ†æ”¯ {branch} æ— æ³•è¯»å–: {e}")

    if found_files:
        print("\nâœ… æ‰¾åˆ°ä»¥ä¸‹åŒ¹é…ç»“æœï¼š\n")
        for branch, path in found_files:
            print(f"ğŸ“Œ åˆ†æ”¯: {branch} | è·¯å¾„: {path}")
    else:
        print("\nâŒ æ²¡æœ‰ä»»ä½•è·¯å¾„åŒ…å« `demon`")

if __name__ == "__main__":
    scan_demon_files()







import requests

# === ä½ çš„ GitLab é…ç½® ===
GITLAB_URL = "https://aaa-aaa-viewer.rmb-ccc.jp"
PROJECT_ID = 59  # å…ˆç”¨ 59ï¼Œå¦‚æœä¹‹åç¡®å®šæ˜¯å…¶ä»– ID å†æ¢
ACCESS_TOKEN = "ä½ çš„TOKEN"

headers = {"PRIVATE-TOKEN": ACCESS_TOKEN}

def get_branches():
    """è·å–æ‰€æœ‰åˆ†æ”¯å"""
    url = f"{GITLAB_URL}/api/v4/projects/{PROJECT_ID}/repository/branches"
    resp = requests.get(url, headers=headers)
    resp.raise_for_status()
    return [b["name"] for b in resp.json()]

def list_files(ref):
    """åˆ—å‡ºæŸåˆ†æ”¯ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼ˆé€’å½’ï¼‰"""
    url = f"{GITLAB_URL}/api/v4/projects/{PROJECT_ID}/repository/tree"
    params = {"ref": ref, "recursive": True, "per_page": 100}
    resp = requests.get(url, headers=headers, params=params)
    resp.raise_for_status()
    return resp.json()

def scan_all_md_files():
    branches = get_branches()
    print(f"âœ… å‘ç° {len(branches)} ä¸ªåˆ†æ”¯ï¼Œå¼€å§‹æ‰«ææ‰€æœ‰ .md æ–‡ä»¶...\n")

    found_files = []

    for branch in branches:
        print(f"ğŸ” æ­£åœ¨æ‰«æåˆ†æ”¯: {branch}")
        try:
            files = list_files(branch)
            for f in files:
                if f["type"] == "blob" and f["path"].endswith(".md"):
                    found_files.append((branch, f["path"]))
        except Exception as e:
            print(f"âš ï¸ åˆ†æ”¯ {branch} æ— æ³•è¯»å–: {e}")

    if found_files:
        print("\nâœ… æ‰¾åˆ°ä»¥ä¸‹ .md æ–‡ä»¶ï¼š\n")
        for branch, path in found_files:
            print(f"ğŸ“Œ åˆ†æ”¯: {branch} | è·¯å¾„: {path}")
    else:
        print("\nâŒ æ‰€æœ‰åˆ†æ”¯éƒ½æ²¡æ‰¾åˆ°ä»»ä½• .md æ–‡ä»¶")

if __name__ == "__main__":
    scan_all_md_files()

import requests

# === é…ç½® ===
GITLAB_URL = "https://aaa-aaa-viewer.rmb-ccc.jp"
PROJECT_ID = 59
ACCESS_TOKEN = "ä½ çš„TOKEN"
SEARCH_FILE = "ccc.md"   # ä½ è¦æ‰¾çš„æ–‡ä»¶å

headers = {"PRIVATE-TOKEN": ACCESS_TOKEN}

def get_branches():
    """è·å–æ‰€æœ‰åˆ†æ”¯"""
    url = f"{GITLAB_URL}/api/v4/projects/{PROJECT_ID}/repository/branches"
    resp = requests.get(url, headers=headers)
    resp.raise_for_status()
    return [b["name"] for b in resp.json()]

def list_files(ref):
    """åˆ—å‡ºæŸä¸ªåˆ†æ”¯çš„æ‰€æœ‰æ–‡ä»¶ï¼ˆé€’å½’ï¼‰"""
    url = f"{GITLAB_URL}/api/v4/projects/{PROJECT_ID}/repository/tree"
    params = {"ref": ref, "recursive": True, "per_page": 100}
    resp = requests.get(url, headers=headers, params=params)
    resp.raise_for_status()
    return resp.json()

def search_file_in_all_branches():
    branches = get_branches()
    print(f"âœ… æ‰¾åˆ° {len(branches)} ä¸ªåˆ†æ”¯ï¼Œå¼€å§‹æœç´¢ `{SEARCH_FILE}` ...\n")

    found_results = []

    for branch in branches:
        print(f"ğŸ” æ­£åœ¨æ£€æŸ¥åˆ†æ”¯: {branch} ...")
        try:
            files = list_files(branch)
            for f in files:
                if f["type"] == "blob" and f["path"].endswith(SEARCH_FILE):
                    found_results.append((branch, f["path"]))
        except Exception as e:
            print(f"âš ï¸ æ— æ³•è¯»å–åˆ†æ”¯ {branch}: {e}")

    if found_results:
        print("\nâœ… æ‰¾åˆ°ä»¥ä¸‹åŒ¹é…ç»“æœï¼š\n")
        for branch, path in found_results:
            print(f"ğŸ“Œ åˆ†æ”¯: {branch}  | è·¯å¾„: {path}")
    else:
        print("\nâŒ åœ¨æ‰€æœ‰åˆ†æ”¯ä¸­éƒ½æ²¡æœ‰æ‰¾åˆ° `ccc.md`")

if __name__ == "__main__":
    search_file_in_all_branches()




import requests
import json

# === ä½ çš„é…ç½® ===
GITLAB_URL = "https://aaa-aaa-viewer.rmb-ccc.jp"
PROJECT_ID = 59
ACCESS_TOKEN = "ä½ çš„TOKEN"

def list_branches():
    api_url = f"{GITLAB_URL}/api/v4/projects/{PROJECT_ID}/repository/branches"
    headers = {"PRIVATE-TOKEN": ACCESS_TOKEN}

    resp = requests.get(api_url, headers=headers)
    if resp.status_code == 200:
        branches = resp.json()
        print(f"âœ… è¿™ä¸ªé¡¹ç›®å…±æœ‰ {len(branches)} ä¸ªåˆ†æ”¯:\n")
        for b in branches:
            name = b["name"]
            default = "â­ é»˜è®¤åˆ†æ”¯" if b.get("default") else ""
            commit_id = b["commit"]["short_id"]
            print(f"- {name:30} (commit {commit_id}) {default}")
    else:
        print(f"âŒ è·å–åˆ†æ”¯å¤±è´¥: {resp.status_code}")
        print(resp.text)

if __name__ == "__main__":
    list_branches()



æ˜ç™½äº†ï¼ä½ åœ¨ feature/202407 åˆ†æ”¯ä¸‹è·‘

.../repository/tree?ref=feature%2F202407

ç»“æœ GitLab è¿”å› 404 Tree Not Foundï¼Œè¿™è¯´æ˜ï¼š
	â€¢	åˆ†æ”¯ feature/202407 æ˜¯å­˜åœ¨çš„ï¼ˆå› ä¸º default_branch å°±æ˜¯å®ƒï¼‰
	â€¢	ä½†æ˜¯åœ¨è¿™ä¸ªåˆ†æ”¯ä¸‹ï¼Œæ ¹ç›®å½•æ˜¯ç©ºçš„ï¼Œæˆ–è€… API è¯·æ±‚è·¯å¾„ä¸å¯¹

â¸»

âœ… ä¸ºä»€ä¹ˆä¼šå‡ºç° Tree Not Foundï¼Ÿ

GitLab åœ¨ 3 ç§æƒ…å†µä¸‹ä¼šè¿”å›è¿™ä¸ªï¼š
	1.	è¿™ä¸ªåˆ†æ”¯ç¡®å®æ²¡æœ‰ä»»ä½•æ–‡ä»¶ï¼ˆæå°‘è§ï¼Œä½†å¯èƒ½è¿™ä¸ªåˆ†æ”¯æ˜¯ç©ºçš„ï¼‰
	2.	è¿™ä¸ªåˆ†æ”¯å¯¹åº”çš„ä¸æ˜¯åˆ†æ”¯ï¼Œè€Œæ˜¯ tag/commitï¼Œæ— æ³•åˆ— tree
	3.	é¡¹ç›®ä¸æ˜¯æ ‡å‡†ä»“åº“ï¼Œè€Œæ˜¯é•œåƒã€å­æ¨¡å—ï¼Œæ ¹ç›®å½•æ²¡å†…å®¹

â¸»

âœ… æˆ‘ä»¬ç¡®è®¤ä¸€ä¸‹ï¼šè¿™ä¸ªåˆ†æ”¯æœ‰æ²¡æœ‰å†…å®¹ï¼Ÿ

æ¢ä¸ªå‘½ä»¤ï¼Œä¸“é—¨çœ‹è¿™ä¸ªåˆ†æ”¯çš„æœ€åä¸€æ¬¡æäº¤ä¿¡æ¯ï¼š

curl --header "PRIVATE-TOKEN: <ä½ çš„TOKEN>" ^
"https://aaa-aaa-viewer.rmb-ccc.jp/api/v4/projects/59/repository/commits?ref_name=feature%2F202407&per_page=1"

âœ… å¦‚æœèƒ½è¿”å› JSONï¼Œä¾‹å¦‚ï¼š

[
  {
    "id": "abc1234...",
    "short_id": "abc1234",
    "title": "Initial commit",
    "author_name": "xxx",
    ...
  }
]

è¯´æ˜åˆ†æ”¯é‡Œç¡®å®æœ‰ commit â†’ é‚£åº”è¯¥æœ‰æ–‡ä»¶ï¼Œåªæ˜¯æˆ‘ä»¬ tree è¯·æ±‚è·¯å¾„å¯èƒ½è¿˜ä¸å¯¹ã€‚

âŒ å¦‚æœè¿™ä¸ªä¹Ÿ 404 â†’ è¯´æ˜ feature/202407 è¿™ä¸ªåˆ†æ”¯å‡ ä¹æ˜¯ç©ºçš„ï¼ˆæ²¡æœ‰ä»»ä½•æ–‡ä»¶ï¼‰ã€‚

â¸»

âœ… è¿˜æœ‰ä¸€ç§å¯èƒ½ï¼šGitLab ä¸æ˜¯æ ‡å‡† repo

å¦‚æœä½ çš„ GitLab é¡¹ç›® ä¸æ˜¯æ™®é€šä»£ç ä»“åº“ï¼ˆæ¯”å¦‚å®ƒåªæ˜¯ä¸€ä¸ªç©ºå£³ã€åªå­˜ CI é…ç½®ã€æˆ–è€…æ˜¯é•œåƒé¡¹ç›®ï¼‰ï¼Œtree API ä¹Ÿä¼šè¿”å› 404ã€‚

â¸»

âœ… å»ºè®®ä¸€æ­¥æ­¥æ’æŸ¥

1ï¸âƒ£ å…ˆç¡®è®¤ feature/202407 åˆ†æ”¯æœ‰æ²¡æœ‰ commit

curl --header "PRIVATE-TOKEN: <ä½ çš„TOKEN>" ^
"https://aaa-aaa-viewer.rmb-ccc.jp/api/v4/projects/59/repository/commits?ref_name=feature%2F202407&per_page=1"

2ï¸âƒ£ å¦‚æœæœ‰ commitï¼Œå†ç»§ç»­æ’æŸ¥ tree ä¸ºä»€ä¹ˆæ²¡å†…å®¹

3ï¸âƒ£ å¦‚æœè¿ commit éƒ½æ²¡æœ‰ â†’ è¯´æ˜è¿™ä¸ªåˆ†æ”¯æœ¬èº«å°±æ˜¯ç©ºçš„ï¼Œæ²¡æ³•ä¸‹è½½æ–‡ä»¶

â¸»

âœ… å¯èƒ½çš„æœ€ç»ˆç»“è®º
	â€¢	å¦‚æœ feature/202407 åˆ†æ”¯é‡Œç¡®å®æ²¡æ–‡ä»¶ â†’ ä½ æƒ³è¦çš„ ccc.md æ ¹æœ¬ä¸åœ¨è¿™ä¸ªåˆ†æ”¯ï¼Œå¯èƒ½åœ¨åˆ«çš„åˆ†æ”¯ï¼ˆmain/masterï¼‰
	â€¢	å¦‚æœ feature/202407 åˆ†æ”¯é‡Œæœ‰ commit â†’ æˆ‘ä»¬å°±è¦è¿›ä¸€æ­¥ç¡®è®¤è·¯å¾„

â¸»

ğŸ‘‰ å»ºè®®ä½ å…ˆè·‘ commit å‘½ä»¤ï¼Œçœ‹åˆ†æ”¯é‡Œåˆ°åº•æœ‰æ²¡æœ‰ä¸œè¥¿

è¦ä¸è¦æˆ‘å¸®ä½  ç»„åˆæˆä¸€ä¸ªå‘½ä»¤ï¼Œä¸€æ¬¡æ€§ç¡®è®¤åˆ†æ”¯é‡Œæ˜¯å¦æœ‰ commit & æ–‡ä»¶æ•°ï¼Ÿ




æ˜ç™½ï¼Œç”¨é¡¹ç›® ID è¿˜æ˜¯ 404ï¼Œé‚£å°±è¯´æ˜è¿˜æœ‰ä¸€ä¸ªç¯èŠ‚æ²¡å®Œå…¨å¯¹ä¸Šï¼Œæˆ‘ä»¬ç°åœ¨ä¸€æ­¥æ­¥ç²¾ç¡®æ’æŸ¥é—®é¢˜ï¼Œç›´åˆ°æ‰¾åˆ°åŸå› ã€‚

â¸»

âœ… ç›®å‰æˆ‘ä»¬ç¡®å®šçš„

âœ… é¡¹ç›® ID = 59 æ˜¯å¯¹çš„ï¼ˆGitLab å·²ç»è¿”å› JSONï¼‰
âœ… åˆ†æ”¯å demo çœ‹èµ·æ¥æ²¡é—®é¢˜ï¼ˆä» /blob/demo/ å–åˆ°ï¼‰
âœ… æ–‡ä»¶è·¯å¾„ aaa/bbb/ccc.md çœ‹ä¼¼æ­£ç¡®

ä½†æ˜¯ API è¿˜æ˜¯ 404 â†’ è¯´æ˜ GitLab è¿˜æ˜¯æ‰¾ä¸åˆ°æ–‡ä»¶ã€‚

â¸»

âœ… 404 å¯èƒ½å‰©ä¸‹çš„ä¸¤ä¸ªåŸå› 
	1.	æ–‡ä»¶è·¯å¾„å†™æ³•ä¸å¯¹ï¼ˆå¤§å°å†™/ç›®å½•ç»“æ„ï¼‰
	â€¢	å¯èƒ½å®é™…è·¯å¾„æ˜¯ AAA/bbb/ccc.md æˆ– aaa/bbb/CCC.md
	â€¢	æˆ–è€…ä¸­é—´è¿˜æœ‰ä¸€å±‚ src/aaa/bbb/ccc.md
	â€¢	GitLab å¯¹è·¯å¾„å¤§å°å†™æ•æ„Ÿ
	2.	åˆ†æ”¯ demo ä¸æ˜¯çœŸå®åˆ†æ”¯å
	â€¢	å¯èƒ½å®é™…æ˜¯ Demoï¼ˆå¤§å°å†™ä¸åŒï¼‰
	â€¢	å¯èƒ½ blob/demo å…¶å®æ˜¯ä¸€ä¸ª tag æˆ– commitï¼Œä¸æ˜¯åˆ†æ”¯

â¸»

âœ… ä¸‹ä¸€æ­¥ â†’ ç²¾ç¡®ç¡®è®¤çœŸå®è·¯å¾„ & åˆ†æ”¯

æˆ‘ä»¬ç›´æ¥ç”¨ API åˆ—å‡ºä»“åº“çš„æ–‡ä»¶æ ‘ï¼Œçœ‹çœ‹çœŸå®çš„è·¯å¾„é•¿ä»€ä¹ˆæ ·ã€‚

â¸»

1ï¸âƒ£ åˆ—å‡ºé¡¹ç›® 59 æ‰€æœ‰åˆ†æ”¯

curl --header "PRIVATE-TOKEN: <token>" \
"https://aaa-aaa-viewer.rmb-ccc.jp/api/v4/projects/59/repository/branches"

âœ… ä½ ä¼šçœ‹åˆ°ç±»ä¼¼ï¼š

[
  { "name": "main", ... },
  { "name": "demo", ... },
  ...
]

â†’ è¿™æ ·æˆ‘ä»¬ç¡®è®¤ demo æ˜¯ä¸æ˜¯ä¸€ä¸ªçœŸå®åˆ†æ”¯åï¼Œè¿˜æ˜¯å†™é”™å¤§å°å†™ã€‚

â¸»

2ï¸âƒ£ åˆ—å‡º demo åˆ†æ”¯ä¸‹çš„ aaa ç›®å½•

curl --header "PRIVATE-TOKEN: <token>" \
"https://aaa-aaa-viewer.rmb-ccc.jp/api/v4/projects/59/repository/tree?ref=demo&path=aaa"

âœ… å®ƒä¼šè¿”å› demo åˆ†æ”¯ä¸‹ aaa ç›®å½•é‡Œçš„æ–‡ä»¶/å­ç›®å½•ï¼Œæ¯”å¦‚ï¼š

[
  { "type": "tree", "name": "bbb" }
]

å¦‚æœæ²¡è¿”å›ï¼Œè¯´æ˜ aaa è¿™ä¸ªç›®å½•æœ¬èº«å°±ä¸å­˜åœ¨ï¼ˆå¯èƒ½å¤§å°å†™é”™äº†ï¼‰ã€‚

â¸»

3ï¸âƒ£ ç»§ç»­åˆ— bbb ç›®å½•

curl --header "PRIVATE-TOKEN: <token>" \
"https://aaa-aaa-viewer.rmb-ccc.jp/api/v4/projects/59/repository/tree?ref=demo&path=aaa/bbb"

âœ… å®ƒä¼šæ˜¾ç¤º ccc.md æ˜¯å¦çœŸçš„å­˜åœ¨ã€‚

â¸»

âœ… å¦‚æœèƒ½çœ‹åˆ° ccc.md

é‚£å°±è¯´æ˜çœŸå®è·¯å¾„æ˜¯ aaa/bbb/ccc.mdï¼Œä¸‹è½½å‘½ä»¤æ‰æ˜¯æ­£ç¡®çš„ï¼š

https://.../projects/59/repository/files/aaa%2Fbbb%2Fccc.md/raw?ref=demo

å¦‚æœæ²¡çœ‹åˆ°ï¼Œé‚£å°±è¯´æ˜ï¼š
	â€¢	è·¯å¾„å¤§å°å†™ä¸å¯¹
	â€¢	æˆ–è€…è¿˜æœ‰å¤šä¸€å±‚ç›®å½•
	â€¢	æˆ–è€…è¿™ä¸ªæ–‡ä»¶æ ¹æœ¬ä¸åœ¨ demo åˆ†æ”¯

â¸»

âœ… è¦ä¸è¦æˆ‘ç»™ä½ å®Œæ•´æ’æŸ¥å‘½ä»¤é›†ï¼Ÿ

æˆ‘å¯ä»¥ä¸€æ¬¡æ€§ç»™ä½  3 æ¡å‘½ä»¤ï¼š

1ï¸âƒ£ åˆ—å‡ºæ‰€æœ‰åˆ†æ”¯ â†’ ç¡®è®¤ demo æ˜¯å¦çœŸå®å­˜åœ¨
2ï¸âƒ£ åˆ—å‡º demo åˆ†æ”¯ä¸‹ aaa ç›®å½• â†’ ç¡®è®¤æœ‰æ—  bbb
3ï¸âƒ£ åˆ—å‡º aaa/bbb ç›®å½• â†’ ç¡®è®¤æœ‰æ—  ccc.md

è·‘å®Œè¿™ä¸‰æ¡å‘½ä»¤ï¼Œæˆ‘ä»¬å°±èƒ½ 100% ç¡®å®šè·¯å¾„é—®é¢˜ï¼

â¸»

ğŸ‘‰ ä½ è¦ä¸è¦æˆ‘ç›´æ¥ç»™ä½ è¿™ 3 æ¡å‘½ä»¤ä¸€æ­¥æ­¥æ’æŸ¥ï¼Œæ‰¾å‡ºçœŸæ­£çš„æ–‡ä»¶è·¯å¾„ï¼Ÿ






æ˜ç™½äº†ï¼æˆ‘ä»¬ç°åœ¨ä¿¡æ¯å·²ç»å®Œæ•´äº†ï¼š
	â€¢	âœ… é¡¹ç›® IDï¼š59
	â€¢	âœ… åˆ†æ”¯åï¼šdemoï¼ˆblob/ åé¢é‚£ä¸ªï¼‰
	â€¢	âœ… æ–‡ä»¶è·¯å¾„ï¼šaaa/bbb/ccc.md

æ¥ä¸‹æ¥åªéœ€è¦æŠŠæ–‡ä»¶è·¯å¾„é‡Œçš„ / è½¬ä¹‰æˆ %2Fï¼Œå°±å¯ä»¥æ‹¼å‡ºæœ€ç»ˆä¸‹è½½ APIã€‚

â¸»

âœ… è½¬ä¹‰åçš„æ–‡ä»¶è·¯å¾„

aaa/bbb/ccc.md  â†’  aaa%2Fbbb%2Fccc.md


â¸»

âœ… æœ€ç»ˆä¸‹è½½ API URL

https://aaa-aaa-viewer.rmb-ccc.jp/api/v4/projects/59/repository/files/aaa%2Fbbb%2Fccc.md/raw?ref=demo


â¸»

âœ… æœ€ç»ˆ curl å‘½ä»¤

curl --header "PRIVATE-TOKEN: <ä½ çš„TOKEN>" ^
     -O "https://aaa-aaa-viewer.rmb-ccc.jp/api/v4/projects/59/repository/files/aaa%2Fbbb%2Fccc.md/raw?ref=demo"

âœ… æ‰§è¡Œåå°±ä¼šä¸‹è½½åˆ°å½“å‰ç›®å½•ï¼Œæ–‡ä»¶å ccc.mdï¼Œé‡Œé¢å°±æ˜¯ Markdown å†…å®¹ï¼Œè€Œä¸æ˜¯ HTML æˆ– 404ã€‚

â¸»

âœ… æ€»ç»“ä½ éœ€è¦åšçš„

1ï¸âƒ£ ä½ å·²ç»æœ‰ id=59 âœ…
2ï¸âƒ£ ä½ å·²ç»çŸ¥é“åˆ†æ”¯æ˜¯ demo âœ…
3ï¸âƒ£ æ–‡ä»¶è·¯å¾„æ˜¯ aaa/bbb/ccc.md âœ…

ç›´æ¥è·‘ä¸Šé¢è¿™æ¡ curl å‘½ä»¤å°±èƒ½æˆåŠŸã€‚

â¸»

âœ… è¿›é˜¶

å¦‚æœä»¥åè¿˜æœ‰åˆ«çš„æ–‡ä»¶ï¼Œåªè¦æ¢ aaa/bbb/xxx.md â†’ aaa%2Fbbb%2Fxxx.md å°±è¡Œï¼Œé¡¹ç›® ID 59 å’Œåˆ†æ”¯ demo ä¸å˜ã€‚

â¸»

è¦ä¸è¦æˆ‘å†ç»™ä½ ä¸€ä¸ªå°å‘½ä»¤ï¼Œè‡ªåŠ¨æŠŠ aaa/bbb/ccc.md è¿™ç§è·¯å¾„è½¬æˆ aaa%2Fbbb%2Fccc.mdï¼Œè®©ä½ ä»¥åä¸ç”¨æ‰‹åŠ¨æ”¹ %2Fï¼Ÿ

è¿˜æ˜¯å…ˆç›´æ¥è·‘ä¸Šé¢çš„ curl çœ‹èƒ½å¦æˆåŠŸä¸‹è½½ï¼Ÿ



æ˜ç™½äº†ï¼æˆ‘ä»¬ç”¨ä½ æè¿°çš„å ä½ç¬¦ å®Œæ•´è¿˜åŸç»“æ„ï¼Œä¸€æ­¥ä¸€æ­¥æ‹†åˆ†ã€‚

â¸»

âœ… ä½ ç»™çš„åŸå§‹ URLï¼ˆå ä½ç¬¦ç‰ˆï¼‰

aaa-aaa-viewer.rmb-ccc.jp/root/cccc/-/blob/demo/aaa/aaa/ccc.md

æ‹†è§£åç»“æ„æ˜¯ï¼š
	â€¢	åŸŸå

aaa-aaa-viewer.rmb-ccc.jp


	â€¢	é¡¹ç›®è·¯å¾„

root/cccc


	â€¢	åˆ†æ”¯å

demo  â† åœ¨ blob åé¢ç´§è·Ÿçš„å°±æ˜¯åˆ†æ”¯å


	â€¢	æ–‡ä»¶è·¯å¾„

aaa/aaa/ccc.md



â¸»

âœ… GitLab API è§„åˆ™

API ä¸‹è½½å¿…é¡»å˜æˆï¼š

https://<åŸŸå>/api/v4/projects/<URL_ENCODED_PROJECT_PATH>/repository/files/<URL_ENCODED_FILE_PATH>/raw?ref=<BRANCHNAME>

å¿…é¡»è½¬ä¹‰ / ä¸º %2F
	â€¢	root/cccc â†’ root%2Fcccc âœ…
	â€¢	aaa/aaa/ccc.md â†’ aaa%2Faaa%2Fccc.md âœ…

â¸»

âœ… è½¬æ¢åçš„ API URL

æ‰€ä»¥å®ƒåº”è¯¥å˜æˆï¼š

https://aaa-aaa-viewer.rmb-ccc.jp/api/v4/projects/root%2Fcccc/repository/files/aaa%2Faaa%2Fccc.md/raw?ref=demo


â¸»

âœ… æœ€ç»ˆ curl å‘½ä»¤

curl --header "PRIVATE-TOKEN: <ä½ çš„TOKEN>" ^
     -O "https://aaa-aaa-viewer.rmb-ccc.jp/api/v4/projects/root%2Fcccc/repository/files/aaa%2Faaa%2Fccc.md/raw?ref=demo"

âœ… è¿™æ ·å°±åº”è¯¥è¿”å›çœŸæ­£çš„ ccc.md æ–‡ä»¶ï¼Œè€Œä¸æ˜¯ 404 æˆ– HTMLã€‚

â¸»

âœ… ä½†æ˜¯ï¼Œæœ‰ä¸¤ä¸ªå¯èƒ½çš„å‘
	1.	é¡¹ç›®è·¯å¾„ä¸ä¸€å®šçœŸæ˜¯ root/cccc
	â€¢	å¯èƒ½å…¶å®æ˜¯é¡¶çº§é¡¹ç›® ccccï¼ˆä¸è¦ root/ï¼‰
	â€¢	ä½ å¯ä»¥è¯•ä¸€ä¸‹ï¼š

curl --header "PRIVATE-TOKEN: <token>" \
"https://aaa-aaa-viewer.rmb-ccc.jp/api/v4/projects/cccc"


	2.	åˆ†æ”¯ demo å¯èƒ½ä¸æ˜¯é»˜è®¤åˆ†æ”¯
	â€¢	éœ€è¦ç¡®è®¤ demo çœŸçš„å­˜åœ¨ï¼š

curl --header "PRIVATE-TOKEN: <token>" \
"https://aaa-aaa-viewer.rmb-ccc.jp/api/v4/projects/root%2Fcccc/repository/branches"



â¸»

âœ… ä¿é™©åšæ³• â†’ ç”¨é¡¹ç›® IDï¼Œé¿å…è·¯å¾„çŒœé”™

å¯ä»¥ç›´æ¥åˆ—å‡ºä½ æœ‰æƒé™çš„æ‰€æœ‰é¡¹ç›® IDï¼š

curl --header "PRIVATE-TOKEN: <token>" \
"https://aaa-aaa-viewer.rmb-ccc.jp/api/v4/projects?membership=true&per_page=100"

ç„¶åæ‰¾åˆ° cccc çš„ idï¼Œç”¨ ID ä¸‹è½½ï¼Œ100% ä¸ä¼šé”™ï¼š

https://aaa-aaa-viewer.rmb-ccc.jp/api/v4/projects/<ID>/repository/files/aaa%2Faaa%2Fccc.md/raw?ref=demo


â¸»

âœ… ä½ ç°åœ¨å¯ä»¥æ€ä¹ˆè¯•
	1.	å…ˆç”¨è·¯å¾„ root/cccc è¯•ä¸€ä¸‹ï¼š

curl --header "PRIVATE-TOKEN: <token>" \
"https://aaa-aaa-viewer.rmb-ccc.jp/api/v4/projects/root%2Fcccc"

	2.	å¦‚æœ 404ï¼Œå†è¯•é¡¶çº§é¡¹ç›® ccccï¼š

curl --header "PRIVATE-TOKEN: <token>" \
"https://aaa-aaa-viewer.rmb-ccc.jp/api/v4/projects/cccc"

	3.	éƒ½ä¸è¡Œï¼Œå°±åˆ—é¡¹ç›® IDï¼Œæ‰¾åˆ°çœŸå®è·¯å¾„ï¼š

curl --header "PRIVATE-TOKEN: <token>" \
"https://aaa-aaa-viewer.rmb-ccc.jp/api/v4/projects?membership=true&per_page=100"


â¸»

âœ… è¦ä¸è¦æˆ‘å¸®ä½ ä¸€æ¬¡æ€§ç”Ÿæˆ
	â€¢	ç”¨è·¯å¾„ root/cccc çš„ curl å‘½ä»¤
	â€¢	ç”¨è·¯å¾„ cccc çš„ curl å‘½ä»¤
	â€¢	ç”¨é¡¹ç›® ID çš„ curl æ¨¡æ¿

è¿™æ ·ä½ ä¸€æ­¥æ­¥è¯•ï¼Œæ‰¾åˆ°å“ªä¸ªé¡¹ç›®è·¯å¾„æ‰å¯¹ï¼Ÿ

ğŸ‘‰ è¦ä¸è¦æˆ‘ç›´æ¥ç»™ä½  ä¸‰ä¸ªå‘½ä»¤ä¸€æ­¥ä¸€æ­¥æ’æŸ¥ï¼Ÿ




curl --header "PRIVATE-TOKEN: <ä½ çš„TOKEN>" ^
     -O "https://aaa-aaa-viewer.rmb-ccc.jp/api/v4/projects/root%2Fcccc/repository/files/aaa%2Faaa%2Fccc.md/raw?ref=demo"




æ˜ç™½äº†ï¼ä¸‹è½½ä¹‹åå¾—åˆ° 404 Not Foundï¼ˆä½ è¯´çš„ Alla404NonFund åº”è¯¥æ˜¯ GitLab è¿”å›çš„ 404 Not Found é¡µé¢ï¼‰ã€‚

è¿™è¯´æ˜ GitLab API è¯·æ±‚æˆåŠŸäº†ï¼Œä½†å®ƒæ‰¾ä¸åˆ°è¿™ä¸ªæ–‡ä»¶ã€‚

å‡ºç° 404 Not Found çš„åŸå› é€šå¸¸åªæœ‰ ä¸‰ç§ï¼Œæˆ‘ä»¬é€ä¸€æ’æŸ¥ï¼š

â¸»

âœ… 1. é¡¹ç›®è·¯å¾„ä¸å¯¹ï¼ˆæœ€å¸¸è§ï¼‰

GitLab API é‡Œçš„é¡¹ç›®è·¯å¾„å¿…é¡»æ˜¯ URL Encode ä¹‹åçš„ namespace%2Fprojectã€‚
	â€¢	ä½ åŸå§‹ URL é‡Œæ˜¯ root/demo-projï¼Œå¿…é¡»å†™æˆ root%2Fdemo-proj
	â€¢	å¦‚æœä½ æ²¡è½¬ä¹‰ /ï¼ŒGitLab è®¤ä¸ºä½ è¦æ‰¾ root è¿™ä¸ªé¡¹ç›® â†’ æ‰¾ä¸åˆ° â†’ 404

ç¡®è®¤æ–¹æ³•

curl --header "PRIVATE-TOKEN: <token>" \
"https://AABBBCCCDDDEEFF.jp/api/v4/projects/root%2Fdemo-proj"

âœ… å¦‚æœèƒ½è¿”å› JSONï¼ˆé¡¹ç›®è¯¦æƒ…ï¼‰ï¼Œè¯´æ˜é¡¹ç›®è·¯å¾„æ²¡é—®é¢˜
âŒ å¦‚æœè¿˜æ˜¯ 404ï¼Œè¯´æ˜é¡¹ç›®è·¯å¾„æ²¡å†™å¯¹æˆ–æ²¡è½¬ä¹‰

â¸»

âœ… 2. åˆ†æ”¯åä¸å¯¹

?ref=BRANCHNAME é‡Œçš„åˆ†æ”¯åå¿…é¡»è·Ÿä»“åº“é‡Œå®Œå…¨ä¸€è‡´ã€‚
	â€¢	å¦‚æœä»“åº“é»˜è®¤åˆ†æ”¯æ˜¯ masterï¼Œä½†ä½ å†™ main â†’ 404
	â€¢	å¦‚æœåˆ†æ”¯æ˜¯ feature/demo-2025ï¼Œè¦å†™ feature%2Fdemo-2025 â†’ 404

ç¡®è®¤æ–¹æ³•

curl --header "PRIVATE-TOKEN: <token>" \
"https://AABBBCCCDDDEEFF.jp/api/v4/projects/root%2Fdemo-proj/repository/branches"

âœ… ä¼šåˆ—å‡ºæ‰€æœ‰åˆ†æ”¯ï¼ˆæ¯”å¦‚ main, master, developï¼‰
â†’ ä½ è¦ç”¨è·Ÿ /blob/<è¿™é‡Œ> ä¸€æ¨¡ä¸€æ ·çš„åˆ†æ”¯å

â¸»

âœ… 3. æ–‡ä»¶è·¯å¾„ä¸å¯¹æˆ–æ²¡è½¬ä¹‰

GitLab API é‡Œçš„æ–‡ä»¶è·¯å¾„å¿…é¡»æ˜¯ä»“åº“é‡Œçš„å®Œæ•´ç›¸å¯¹è·¯å¾„ï¼Œå¹¶ä¸” URL Encodeã€‚
	â€¢	docs/tutorial/readme.md â†’ docs%2Ftutorial%2Freadme.md âœ…
	â€¢	å¦‚æœæ¼æ‰ tutorial ç›®å½•æˆ–å¤§å°å†™ä¸ä¸€è‡´ â†’ 404
	â€¢	å¦‚æœä¸è½¬ä¹‰ / â†’ GitLab è®¤ä¸ºæ˜¯ç›®å½• â†’ 404

ç¡®è®¤æ–¹æ³•

curl --header "PRIVATE-TOKEN: <token>" \
"https://AABBBCCCDDDEEFF.jp/api/v4/projects/root%2Fdemo-proj/repository/tree?ref=main&path=docs/tutorial"

âœ… å¦‚æœèƒ½çœ‹åˆ° readme.md â†’ è·¯å¾„å¯¹
âŒ å¦‚æœæ²¡æœ‰ â†’ è·¯å¾„é”™äº†

â¸»

âœ… è§£å†³æ€è·¯

è¦é¿å… 404ï¼Œå¿…é¡»ç¡®è®¤è¿™ 3 ä¸ªå…³é”®ï¼š
	1.	âœ… é¡¹ç›®è·¯å¾„ï¼ˆroot/demo-proj â†’ root%2Fdemo-projï¼‰
	2.	âœ… åˆ†æ”¯åï¼ˆblob/ åé¢é‚£ä¸ªåå­—è¦ç²¾ç¡®ä¸€è‡´ï¼‰
	3.	âœ… æ–‡ä»¶è·¯å¾„ï¼ˆdemo/folder/file.md â†’ demo%2Ffolder%2Ffile.mdï¼Œä¸”å¤§å°å†™æ­£ç¡®ï¼‰

â¸»

âœ… å»ºè®®ä½ å…ˆè·‘ 3 ä¸ªæ’æŸ¥å‘½ä»¤

1ï¸âƒ£ ç¡®è®¤é¡¹ç›®è·¯å¾„å¯¹ä¸å¯¹

curl --header "PRIVATE-TOKEN: <token>" \
"https://AABBBCCCDDDEEFF.jp/api/v4/projects/root%2Fdemo-proj"

2ï¸âƒ£ ç¡®è®¤åˆ†æ”¯åˆ°åº•å«ä»€ä¹ˆ

curl --header "PRIVATE-TOKEN: <token>" \
"https://AABBBCCCDDDEEFF.jp/api/v4/projects/root%2Fdemo-proj/repository/branches"

3ï¸âƒ£ ç¡®è®¤æ–‡ä»¶è·¯å¾„åˆ°åº•å¯¹ä¸å¯¹

curl --header "PRIVATE-TOKEN: <token>" \
"https://AABBBCCCDDDEEFF.jp/api/v4/projects/root%2Fdemo-proj/repository/tree?ref=main&path=demo/folder"

	â€¢	âœ… å¦‚æœéƒ½èƒ½æ‰¾åˆ° â†’ å†æ‹¼ API ä¸‹è½½ URL å°±ä¸€å®šä¸ä¼š 404
	â€¢	âŒ å¦‚æœæœ‰ä¸€ä¸ªä¸å¯¹ â†’ ä¿®æ­£åå†è¯•

â¸»

âœ… ä½ æƒ³è®©æˆ‘æ€ä¹ˆå¸®ï¼Ÿ
	â€¢	è¦ä¸è¦æˆ‘å…ˆç»™ä½ æ’æŸ¥å‘½ä»¤ï¼ˆä¸€æ­¥æ­¥ç¡®è®¤é¡¹ç›®ã€åˆ†æ”¯ã€è·¯å¾„ï¼‰ï¼Œå¸®ä½ æ‰¾å‡ºåˆ°åº•å“ªä¸€æ­¥é”™äº†ï¼Ÿ
	â€¢	è¿˜æ˜¯ç›´æ¥å¸®ä½ æ‹¿åŸå§‹ URL è§£æå‡ºæ­£ç¡®çš„é¡¹ç›®è·¯å¾„ã€åˆ†æ”¯ã€æ–‡ä»¶è·¯å¾„ï¼Œå¹¶ç”Ÿæˆæœ€ç»ˆ curl å‘½ä»¤ï¼Ÿ

ğŸ‘‰ ä½ è¦ä¸è¦å…ˆè·‘ç¬¬ 1 æ­¥ï¼ˆç¡®è®¤é¡¹ç›®è·¯å¾„ï¼‰ï¼Œçœ‹èƒ½ä¸èƒ½è¿”å› JSONï¼Ÿ







import urllib.parse, os

ACCESS_TOKEN = "glpat-ä½ çš„TOKEN"

raw_url = input("è¯·è¾“å…¥å®¢æˆ·ç»™çš„ /blob/ URL: ").strip()

parts = raw_url.split("/")
domain = parts[2]
proj_path = "%2F".join(parts[3:parts.index("-")])
branch = parts[parts.index("blob") + 1]
file_path = "%2F".join(parts[parts.index("blob") + 2:])
filename = raw_url.split("/")[-1]

api_url = f"https://{domain}/api/v4/projects/{proj_path}/repository/files/{file_path}/raw?ref={branch}"

print(f"âœ… è½¬æ¢å®Œæˆ: {api_url}")
os.system(f"curl --header \"PRIVATE-TOKEN: {ACCESS_TOKEN}\" -O \"{api_url}\"")




curl --header "PRIVATE-TOKEN: <ä½ çš„Token>" ^
     -O "https://AABBBCCCDDDEEFF.jp/api/v4/projects/root%2Fdemo-proj/repository/files/demo%2Ftutorial%2Fguide.md/raw?ref=main"



æ˜ç™½äº†ï¼ä½ çš„å…¬å¸/å®¢æˆ·çš„ GitLab åŸŸåæ˜¯ç±»ä¼¼ï¼š

https://devops.xxx.jp

ä¹Ÿå°±æ˜¯ä¸€ä¸ªæ—¥æœ¬åç¼€ .jp çš„ å†…éƒ¨è‡ªå»º GitLabï¼Œæ‰€ä»¥æˆ‘ä»¬å¿…é¡»ç”¨è¿™ä¸ªåŸŸåæ¥è°ƒç”¨ APIï¼Œè€Œä¸èƒ½ç”¨ https://gitlab.comã€‚

âœ… å¥½æ¶ˆæ¯æ˜¯ï¼šGitLab API åœ¨ .jp åŸŸåä¸‹ä¸€æ ·èƒ½ç”¨ï¼Œåªè¦ä½ æŠŠåŸŸåæ›¿æ¢æ­£ç¡®ã€‚

â¸»

âœ… ç¬¬ä¸€æ­¥ï¼šå…ˆéªŒè¯ Token æ˜¯å¦å¯¹ .jp åŸŸåæœ‰æ•ˆ

è¯·åœ¨å‘½ä»¤è¡Œé‡Œè¿è¡Œï¼ˆæŠŠ <ä½ çš„Token> æ¢æˆä½ çš„çœŸå® tokenï¼‰ï¼š

curl --header "PRIVATE-TOKEN: <ä½ çš„Token>" https://devops.xxx.jp/api/v4/user

å¯èƒ½çš„ç»“æœï¼š
	â€¢	âœ… å¦‚æœè¿”å› JSONï¼Œç±»ä¼¼ï¼š

{"id":123,"username":"yourname","email":"xxx@company.jp"}

è¯´æ˜ï¼š
	â€¢	åŸŸåæ­£ç¡®
	â€¢	Token æœ‰æ•ˆ
	â€¢	æƒé™å¤Ÿ

	â€¢	âŒ å¦‚æœè¿”å› HTMLï¼ˆå¸¦ <html> <body> ç™»å½•é¡µï¼‰ â†’
	â€¢	å¯èƒ½ Token æƒé™ä¸è¶³
	â€¢	å¯èƒ½ Token è¾“å…¥é”™
	â€¢	ä¹Ÿå¯èƒ½åŸŸåæ‹¼é”™

â¸»

âœ… ç¬¬äºŒæ­¥ï¼šç¡®å®š GitLab API ä¸‹è½½æ–‡ä»¶çš„å®Œæ•´åœ°å€

å‡è®¾ä½ çš„ GitLab é¡¹ç›®æ˜¯ï¼š
	â€¢	å‘½åç©ºé—´/é¡¹ç›®ï¼šmyteam/myrepo
	â€¢	æ–‡ä»¶è·¯å¾„ï¼šdocs/readme.md
	â€¢	åˆ†æ”¯åï¼šmain

é‚£ä¹ˆæ­£ç¡®çš„ API ä¸‹è½½ URL æ˜¯ï¼š

https://devops.xxx.jp/api/v4/projects/myteam%2Fmyrepo/repository/files/docs%2Freadme.md/raw?ref=main

ç„¶åä½ å¯ä»¥ç›´æ¥ç”¨ curl ä¸‹è½½ï¼š

curl --header "PRIVATE-TOKEN: <ä½ çš„Token>" \
     -O "https://devops.xxx.jp/api/v4/projects/myteam%2Fmyrepo/repository/files/docs%2Freadme.md/raw?ref=main"

âœ… è¿™æ ·å°±èƒ½æ‹¿åˆ°çœŸæ­£çš„ Markdown æ–‡ä»¶ï¼Œè€Œä¸ä¼šæ˜¯ HTML ç™»å½•é¡µé¢ã€‚

â¸»

âœ… ç¬¬ä¸‰æ­¥ï¼šPython è„šæœ¬é€‚é… .jp åŸŸå

æŠŠä¹‹å‰çš„è„šæœ¬é‡Œçš„ GITLAB_URL æ”¹æˆ https://devops.xxx.jp å°±è¡Œï¼Œæ¯”å¦‚ï¼š

GITLAB_URL = "https://devops.xxx.jp"   # âš ï¸ æ”¹æˆä½ ä»¬çš„åŸŸå
ACCESS_TOKEN = "glpat-xxxxxxxxxxxxxxxx"
PROJECT_PATH = "myteam/myrepo"
FILE_PATH = "docs/readme.md"
BRANCH = "main"

è¿è¡Œåå®ƒå°±ä¼šè®¿é—®ï¼š

https://devops.xxx.jp/api/v4/projects/myteam%2Fmyrepo/repository/files/docs%2Freadme.md/raw?ref=main

âœ… è¿™æ ·æ‰èƒ½ä¸‹è½½åˆ°çœŸæ­£çš„æ–‡ä»¶

â¸»

âœ… ä¸‹ä¸€æ­¥æ€ä¹ˆåšï¼Ÿ

1ï¸âƒ£ å…ˆéªŒè¯ Token æ˜¯å¦æœ‰æ•ˆ

curl --header "PRIVATE-TOKEN: <ä½ çš„Token>" https://devops.xxx.jp/api/v4/user

2ï¸âƒ£ å¦‚æœèƒ½è¿”å› JSON âœ… â†’ æˆ‘å¸®ä½ å†™å¥½æœ€ç»ˆä¸‹è½½å‘½ä»¤å’Œ Python ä»£ç 
3ï¸âƒ£ å¦‚æœè¿”å› HTML âŒ â†’ è¯´æ˜ Token æƒé™ä¸è¶³æˆ–åŸŸåä¸å¯¹ï¼Œéœ€è¦ä¿®æ­£

â¸»

ğŸ‘‰ ä½ è¦ä¸è¦ç°åœ¨å°±å…ˆè·‘ç¬¬ 1 æ­¥ curl å‘½ä»¤ï¼Œçœ‹èƒ½ä¸èƒ½è¿”å› JSONï¼Ÿ
å¦‚æœå¯ä»¥ï¼Œæˆ‘ç›´æ¥ç»™ä½ å®Œæ•´ä¸‹è½½è„šæœ¬ã€‚

è¦ä¸è¦æˆ‘ç»™ä½ ä¸€ä¸ª åªè¾“å…¥ URL+Token è‡ªåŠ¨å®ŒæˆéªŒè¯å’Œä¸‹è½½çš„ç®€æ˜“ç‰ˆè„šæœ¬ï¼Ÿ



import requests
import urllib.parse

# === é…ç½®åŒº ===
GITLAB_URL = "https://gitlab.com"   # å¦‚æœæ˜¯è‡ªå»ºGitLabï¼Œæ”¹æˆè‡ªå·±çš„åŸŸå
ACCESS_TOKEN = "YOUR_TOKEN_HERE"   # ä½ çš„GitLab Personal Access Token
PROJECT_PATH = "group/project"     # é¡¹ç›®çš„å‘½åç©ºé—´è·¯å¾„ï¼Œä¾‹å¦‚ myteam/myrepo
FILE_PATH = "docs/example.md"      # ä»“åº“é‡Œçš„æ–‡ä»¶è·¯å¾„
BRANCH = "main"                    # åˆ†æ”¯åï¼Œæ¯”å¦‚ main / master

def check_token():
    """æ£€æŸ¥ GitLab Token æ˜¯å¦æœ‰æ•ˆ"""
    url = f"{GITLAB_URL}/api/v4/user"
    headers = {"PRIVATE-TOKEN": ACCESS_TOKEN}
    print(f"ğŸ” æ­£åœ¨æ£€æŸ¥ Token æ˜¯å¦æœ‰æ•ˆ...")

    resp = requests.get(url, headers=headers)
    
    if resp.status_code == 200:
        try:
            user_info = resp.json()
            print(f"âœ… Token æœ‰æ•ˆï¼Œç”¨æˆ·ï¼š{user_info.get('username')} (ID {user_info.get('id')})")
            return True
        except Exception as e:
            print(f"âš ï¸ Token å“åº”ä¸æ˜¯æœ‰æ•ˆ JSONï¼Œå¯èƒ½æ˜¯ GitLab HTML é¡µé¢")
            print(resp.text[:200])  # æ‰“å°å‰200å­—ç¬¦
            return False
    else:
        print(f"âŒ Token æ— æ•ˆæˆ–æ— æƒé™ï¼ŒçŠ¶æ€ç  {resp.status_code}")
        print(resp.text)
        return False

def download_file():
    """ç”¨ API ä¸‹è½½æ–‡ä»¶"""
    encoded_project = urllib.parse.quote(PROJECT_PATH, safe="")
    encoded_file = urllib.parse.quote(FILE_PATH, safe="")
    api_url = f"{GITLAB_URL}/api/v4/projects/{encoded_project}/repository/files/{encoded_file}/raw?ref={BRANCH}"

    headers = {"PRIVATE-TOKEN": ACCESS_TOKEN}
    print(f"ğŸ” é€šè¿‡ API ä¸‹è½½æ–‡ä»¶ï¼š{FILE_PATH}")
    resp = requests.get(api_url, headers=headers)

    if resp.status_code == 200:
        filename = FILE_PATH.split("/")[-1]
        with open(filename, "wb") as f:
            f.write(resp.content)
        print(f"âœ… æ–‡ä»¶ä¸‹è½½æˆåŠŸï¼š{filename}")
    else:
        print(f"âŒ ä¸‹è½½å¤±è´¥ï¼ŒçŠ¶æ€ç  {resp.status_code}")
        print(resp.text)

if __name__ == "__main__":
    if check_token():
        download_file()
    else:
        print("âš ï¸ è¯·æ£€æŸ¥ Token æ˜¯å¦æ­£ç¡®ï¼Œå¹¶ç¡®è®¤å·²å‹¾é€‰ read_repository æƒé™ã€‚")


import requests
import urllib.parse

# === é…ç½®åŒº ===
GITLAB_URL = "https://gitlab.com"   # å¦‚æœæ˜¯è‡ªå»ºGitLabï¼Œæ”¹æˆè‡ªå·±çš„åŸŸå
ACCESS_TOKEN = "YOUR_TOKEN_HERE"   # ä½ çš„GitLab Personal Access Token
PROJECT_PATH = "group/project"     # é¡¹ç›®çš„å‘½åç©ºé—´è·¯å¾„ï¼Œä¾‹å¦‚ myteam/myrepo
FILE_PATH = "docs/example.md"      # ä»“åº“é‡Œçš„æ–‡ä»¶è·¯å¾„
BRANCH = "main"                    # åˆ†æ”¯åï¼Œæ¯”å¦‚ main / master

# === Step 1: æ£€æŸ¥ Token æ˜¯å¦æœ‰æ•ˆ ===
def check_token():
    url = f"{GITLAB_URL}/api/v4/user"
    headers = {"PRIVATE-TOKEN": ACCESS_TOKEN}
    print(f"ğŸ” æ£€æŸ¥ Token æ˜¯å¦æœ‰æ•ˆ...")
    resp = requests.get(url, headers=headers)
    if resp.status_code == 200:
        user_info = resp.json()
        print(f"âœ… Token æœ‰æ•ˆï¼Œç”¨æˆ·ï¼š{user_info['username']} (ID {user_info['id']})")
        return True
    else:
        print(f"âŒ Token æ— æ•ˆæˆ–æ— æƒé™ï¼ŒçŠ¶æ€ç  {resp.status_code}")
        print(resp.text)
        return False

# === Step 2: ç”¨ API ä¸‹è½½æ–‡ä»¶ ===
def download_file():
    # GitLab API ä¸‹è½½åœ°å€éœ€è¦ URL Encode
    encoded_project = urllib.parse.quote(PROJECT_PATH, safe="")
    encoded_file = urllib.parse.quote(FILE_PATH, safe="")
    api_url = f"{GITLAB_URL}/api/v4/projects/{encoded_project}/repository/files/{encoded_file}/raw?ref={BRANCH}"

    headers = {"PRIVATE-TOKEN": ACCESS_TOKEN}
    print(f"ğŸ” é€šè¿‡ API ä¸‹è½½æ–‡ä»¶ï¼š{FILE_PATH}")
    resp = requests.get(api_url, headers=headers)

    if resp.status_code == 200:
        filename = FILE_PATH.split("/")[-1]
        with open(filename, "wb") as f:
            f.write(resp.content)
        print(f"âœ… æ–‡ä»¶ä¸‹è½½æˆåŠŸï¼š{filename}")
    else:
        print(f"âŒ ä¸‹è½½å¤±è´¥ï¼ŒçŠ¶æ€ç  {resp.status_code}")
        print(resp.text)

if __name__ == "__main__":
    if check_token():
        download_file()
    else:
        print("âš ï¸ è¯·æ£€æŸ¥ Token æ˜¯å¦æ­£ç¡®ï¼Œå¹¶ç¡®è®¤å·²å‹¾é€‰ read_repository æƒé™ã€‚")

æ˜ç™½äº†ï¼ä½ å·²ç»åœ¨æµè§ˆå™¨ç‚¹äº† â€œRawâ€ æŒ‰é’® â†’ å³é”®å¤åˆ¶é“¾æ¥ â†’ ç”¨ curl ä¸‹è½½ï¼Œä½†ç»“æœè¿˜æ˜¯ HTMLï¼ˆæç¤ºé‡å®šå‘æˆ–ç™»å½•ï¼‰ï¼Œè¯´æ˜ï¼š

âœ… è¿™ä¸ªæ–‡ä»¶åœ¨ä¸€ä¸ªç§æœ‰é¡¹ç›®é‡Œ
âœ… GitLabå³ä½¿æ˜¯Rawé“¾æ¥ï¼Œä¹Ÿéœ€è¦ä½ å…ˆè®¤è¯
âœ… ä½ çš„ PRIVATE-TOKEN ç›®å‰æ²¡è¢«æ­£ç¡®è¯†åˆ«æˆ–æƒé™ä¸å¤Ÿ

â¸»

âœ… ä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Ÿ

GitLab å¯¹ç§æœ‰åº“çš„ä¿æŠ¤æ˜¯ï¼š
	â€¢	æµè§ˆå™¨é‡Œä½ å·²ç»ç™»å½•ï¼Œæ‰€ä»¥èƒ½ç›´æ¥çœ‹åˆ° Raw
	â€¢	ä½† curl ä¸æ˜¯ç™»å½•çŠ¶æ€ï¼Œéœ€è¦å¸¦ æ­£ç¡®çš„ Token
	â€¢	å¦‚æœ Token æ— æ•ˆ / æƒé™ä¸å¤Ÿï¼Œå°±ä¼šè¿”å›ä¸€ä¸ªç™»å½•é¡µé¢ (HTML + sign_in)

â¸»

âœ… æ­£ç¡®ä¸‹è½½ç§æœ‰æ–‡ä»¶çš„æ–¹æ³•

å¯¹ç§æœ‰åº“ï¼Œå»ºè®®ç›´æ¥ç”¨ GitLab APIï¼Œè€Œä¸æ˜¯æ™®é€š Raw é“¾æ¥ã€‚

1ï¸âƒ£ API ä¸‹è½½é“¾æ¥æ ¼å¼

https://gitlab.com/api/v4/projects/<URL_ENCODED_PROJECT_PATH>/repository/files/<URL_ENCODED_FILE_PATH>/raw?ref=<BRANCH>

ç¤ºä¾‹ï¼š

https://gitlab.com/api/v4/projects/mygroup%2Fmyrepo/repository/files/docs%2Fexample.md/raw?ref=main

ç„¶åï¼š

curl --header "PRIVATE-TOKEN: <your_token>" -O "https://gitlab.com/api/v4/projects/mygroup%2Fmyrepo/repository/files/docs%2Fexample.md/raw?ref=main"

âœ… è¿™æ · 100% ä¼šå¾—åˆ°çœŸæ­£çš„ Markdown æ–‡ä»¶ã€‚

â¸»

2ï¸âƒ£ ä½†ä½ ç›®å‰åªæœ‰ Raw æŒ‰é’®çš„ URL

é‚£æˆ‘ä»¬å¯ä»¥å…ˆç”¨åŒä¸€ä¸ª Token æµ‹è¯•æƒé™æ˜¯å¦æœ‰æ•ˆï¼š

curl --header "PRIVATE-TOKEN: <your_token>" -I "https://gitlab.com"

å¦‚æœè¿”å› HTTP/2 200 â†’ è¯´æ˜ Token æœ‰æ•ˆ
å¦‚æœè¿”å› 401 Unauthorized â†’ Token æ— æ•ˆæˆ–è€…æ²¡æƒé™

â¸»

âœ… ä½ çš„æƒ…å†µå¾ˆå¯èƒ½æ˜¯ï¼š
	â€¢	Token è¿˜æ²¡æ­£ç¡®å¡«å…¥ï¼ˆå¯èƒ½è¿˜æ˜¯ YOUR_TOKEN æ–‡å­—æ²¡æ¢ï¼‰
	â€¢	Token æƒé™ä¸å¤Ÿï¼ˆéœ€è¦ read_repositoryï¼‰
	â€¢	Token å¯¹åº”çš„æ˜¯é”™è¯¯è´¦å·ï¼ˆæ²¡æƒé™è®¿é—®ç§æœ‰é¡¹ç›®ï¼‰
	â€¢	GitLab æ˜¯è‡ªå»ºçš„ï¼Œå¿…é¡»ç”¨å®Œæ•´åŸŸååŒ¹é…

â¸»

âœ… ä½ ç°åœ¨å¯ä»¥è¿™æ ·æ’æŸ¥
	1.	ç¡®è®¤ Token æ­£ç¡®å¹¶èƒ½ç”¨

curl --header "PRIVATE-TOKEN: <your_token>" "https://gitlab.com/api/v4/user"

âœ… å¦‚æœæ­£å¸¸ï¼Œåº”è¯¥è¿”å›ä½ çš„ç”¨æˆ·ä¿¡æ¯ï¼ˆJSON æ ¼å¼ï¼‰
âŒ å¦‚æœæŠ¥ 401 â†’ Token æœ‰é—®é¢˜
	2.	ç¡®è®¤ Token æœ‰ read_repository æƒé™
	â€¢	GitLab â†’ Settings â†’ Access Tokens â†’ å‹¾é€‰ read_api & read_repository
	3.	ç¡®è®¤é“¾æ¥æ˜¯å¦çœŸæ˜¯ Raw
	â€¢	æµè§ˆå™¨ç‚¹ Raw â†’ å¤åˆ¶é“¾æ¥ â†’ å†æ‰“å¼€æ— ç—•çª—å£
	â€¢	å¦‚æœæ— ç—•é‡Œæ‰“ä¸å¼€ï¼Œè¯´æ˜å®ƒæ˜¯ç§æœ‰çš„ï¼Œå¿…é¡»ç”¨ API

â¸»

âœ… æœ€ç»ˆå»ºè®®

å› ä¸ºæ˜¯ç§æœ‰é¡¹ç›®ï¼Œæœ€ä¿é™©çš„æ–¹æ³•å°±æ˜¯èµ° APIï¼Œè€Œä¸æ˜¯ Raw æŒ‰é’®çš„é“¾æ¥ã€‚
è¦ç”¨ APIï¼Œæˆ‘éœ€è¦çŸ¥é“ï¼š
	â€¢	é¡¹ç›®çš„è·¯å¾„ï¼ˆä¾‹å¦‚ mygroup/myrepoï¼‰
	â€¢	æ–‡ä»¶çš„è·¯å¾„ï¼ˆä¾‹å¦‚ docs/example.mdï¼‰
	â€¢	åˆ†æ”¯åï¼ˆä¾‹å¦‚ mainï¼‰

æˆ‘å°±èƒ½å¸®ä½ æ‹¼å‡ºæ­£ç¡®çš„ API ä¸‹è½½å‘½ä»¤ã€‚

â¸»

è¦ä¸è¦æˆ‘å…ˆç»™ä½ ä¸€ä¸ª è‡ªåŠ¨æ£€æµ‹ Token + API ä¸‹è½½çš„è„šæœ¬ï¼Œä¸€æ­¥å¸®ä½ æå®šï¼Ÿ
è¿˜æ˜¯å…ˆå¸®ä½  æµ‹è¯• Token æ˜¯å¦æœ‰æ•ˆï¼Ÿ

ğŸ‘‰ è¦ä¸è¦å…ˆæµ‹è¯• Tokenï¼Ÿ



curl --header "PRIVATE-TOKEN: YOUR_TOKEN" -O "THE_LINK_YOU_GOT"






import requests
import os

# === Configuration ===
GITLAB_URL = "https://gitlab.com"  # Replace with your GitLab server URL if it's self-hosted
PROJECT_ID = "12345678"            # Replace with your GitLab project ID
FILE_PATH = "docs/example.md"      # Path to the file inside the repo
REF = "main"                       # Branch name or commit hash
ACCESS_TOKEN = "your_personal_access_token"

# Output file name
OUTPUT_FILE = os.path.basename(FILE_PATH)

# === GitLab API endpoint ===
API_URL = f"{GITLAB_URL}/api/v4/projects/{PROJECT_ID}/repository/files/{requests.utils.quote(FILE_PATH, safe='')}/raw?ref={REF}"

# === Send request ===
headers = {"PRIVATE-TOKEN": ACCESS_TOKEN}
response = requests.get(API_URL, headers=headers)

if response.status_code == 200:
    with open(OUTPUT_FILE, "wb") as f:
        f.write(response.content)
    print(f"âœ… File downloaded successfully: {OUTPUT_FILE}")
else:
    print(f"âŒ Failed to download file. Status: {response.status_code}")
    print(response.text)








import psycopg2

# æ¥ç¶šæƒ…å ±ï¼ˆè‡ªåˆ†ã®ç’°å¢ƒã«åˆã‚ã›ã¦ä¿®æ­£ï¼‰
host = "localhost"
port = 5432
dbname = "your_database"
user = "your_username"
password = "your_password"
schema_name = "public"
table_name = "postal_grade_data"

try:
    # PostgreSQL ã«æ¥ç¶š
    conn = psycopg2.connect(
        host=host,
        port=port,
        dbname=dbname,
        user=user,
        password=password
    )
    cursor = conn.cursor()

    # 1. è¡Œæ•°ï¼ˆãƒ¬ã‚³ãƒ¼ãƒ‰æ•°ï¼‰ã‚’å–å¾—
    count_sql = f"SELECT COUNT(*) FROM {schema_name}.{table_name};"
    cursor.execute(count_sql)
    row_count = cursor.fetchone()[0]
    print(f"ãƒ¬ã‚³ãƒ¼ãƒ‰ä»¶æ•°ï¼š{row_count} ä»¶")

    # 2. ãƒ†ãƒ¼ãƒ–ãƒ«ã‚µã‚¤ã‚ºã‚’å–å¾—ï¼ˆäººé–“ãŒèª­ã‚ã‚‹å½¢å¼ï¼‰
    size_sql = f"""
        SELECT
            pg_size_pretty(pg_total_relation_size('{schema_name}.{table_name}')) AS total_size,
            pg_size_pretty(pg_relation_size('{schema_name}.{table_name}')) AS table_size,
            pg_size_pretty(pg_indexes_size('{schema_name}.{table_name}')) AS index_size;
    """
    cursor.execute(size_sql)
    size_result = cursor.fetchone()

    print(f"åˆè¨ˆã‚µã‚¤ã‚º      ï¼š{size_result[0]}")
    print(f"ãƒ†ãƒ¼ãƒ–ãƒ«æœ¬ä½“    ï¼š{size_result[1]}")
    print(f"ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹éƒ¨åˆ†ï¼š{size_result[2]}")

except Exception as e:
    print("ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸï¼š", e)

finally:
    if 'conn' in locals() and conn:
        cursor.close()
        conn.close()
        print("ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã‚’çµ‚äº†ã—ã¾ã—ãŸã€‚")



import pandas as pd
import psycopg2

conn = psycopg2.connect(
    dbname="ä½ çš„æ•°æ®åº“å",
    user="ä½ çš„ç”¨æˆ·å",
    password="ä½ çš„å¯†ç ",
    host="ä½ çš„æ•°æ®åº“åœ°å€",
    port="5432"
)

df = pd.read_sql("SELECT * FROM coooo.aaatable;", conn)
print(df.head())

conn.close()





import psycopg2

# æ›¿æ¢ä¸ºä½ çš„æ•°æ®åº“ä¿¡æ¯
conn = psycopg2.connect(
    dbname="ä½ çš„æ•°æ®åº“å",
    user="ä½ çš„ç”¨æˆ·å",
    password="ä½ çš„å¯†ç ",
    host="ä½ çš„æ•°æ®åº“åœ°å€",  # å¦‚æœæ˜¯æœ¬æœºå¯ä»¥å†™ localhost
    port="5432"  # PostgreSQL é»˜è®¤ç«¯å£
)

# åˆ›å»ºæ¸¸æ ‡
cur = conn.cursor()

# æ‰§è¡Œ SQL æŸ¥è¯¢
cur.execute("SELECT * FROM your_table_name;")

# è·å–æ‰€æœ‰ç»“æœ
rows = cur.fetchall()

# æ‰“å°ç»“æœ
for row in rows:
    print(row)

# å…³é—­è¿æ¥
cur.close()
conn.close()







import pandas as pd
from boxsdk import JWTAuth, Client
import io

# Step 1: ä½ çš„ DataFrame
df = pd.DataFrame({
    'Name': ['Alice', 'Bob'],
    'Age': [25, 30]
})

# Step 2: è®¤è¯ Box APIï¼ˆç”¨ JWT é…ç½®ï¼‰
auth = JWTAuth.from_settings_file('your_jwt_config.json')
client = Client(auth)

# Step 3: åˆ›å»º Excel æ–‡ä»¶åˆ°å†…å­˜ä¸­
excel_buffer = io.BytesIO()
df.to_excel(excel_buffer, index=False, engine='openpyxl')
excel_buffer.seek(0)

# Step 4: é€‰æ‹© Box ä¸­çš„ç›®æ ‡æ–‡ä»¶å¤¹ï¼ˆå¦‚æ ¹ç›®å½•ï¼‰
folder_id = '0'  # æ ¹ç›®å½•ï¼›ä½ ä¹Ÿå¯ä»¥ç”¨å…¶ä»–å…·ä½“æ–‡ä»¶å¤¹çš„ ID

# Step 5: ä¸Šä¼ ä¸ºæ–‡ä»¶
file_name = 'output.xlsx'
uploaded_file = client.folder(folder_id).upload_stream(excel_buffer, file_name)

print(f"æ–‡ä»¶å·²ä¸Šä¼ åˆ° Boxï¼š{uploaded_file.name} (ID: {uploaded_file.id})")





import subprocess
import base64

# Tableau Server ä¿¡æ¯
TABLEAU_SERVER = "https://your-tableau-server.com"
USERNAME = "your_username"
PASSWORD = "your_password"
VIEW_URL = "views/your_dashboard"  # ä½ çš„ä»ªè¡¨æ¿è§†å›¾è·¯å¾„
OUTPUT_FILE = "dashboard.png"

# ä½¿ç”¨ tabcmd ç™»å½• Tableau Server
login_command = [
    "tabcmd", "login",
    "--server", TABLEAU_SERVER,
    "--username", USERNAME,
    "--password", PASSWORD
]

# è¿è¡Œç™»å½•å‘½ä»¤
subprocess.run(login_command, check=True)

# ä½¿ç”¨ tabcmd è·å–ä»ªè¡¨æ¿çš„å›¾ç‰‡
get_image_command = [
    "tabcmd", "get",
    f"{TABLEAU_SERVER}/{VIEW_URL}.png",
    "-o", OUTPUT_FILE
]

# è¿è¡Œä¸‹è½½å‘½ä»¤
subprocess.run(get_image_command, check=True)

# è¯»å–å›¾ç‰‡å¹¶è½¬æ¢ä¸º Base64 ç¼–ç å­—ç¬¦ä¸²
with open(OUTPUT_FILE, "rb") as img_file:
    image_base64 = base64.b64encode(img_file.read()).decode('utf-8')

print(f"ä»ªè¡¨æ¿å›¾ç‰‡çš„ Base64 ç¼–ç å­—ç¬¦ä¸²ä¸ºï¼š{image_base64}")

# ä½¿ç”¨ tabcmd é€€å‡ºç™»å½•
logout_command = ["tabcmd", "logout"]
subprocess.run(logout_command, check=True)
